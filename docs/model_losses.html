---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/model_losses.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/model_losses.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="divide_no_nan" class="doc_header"><code>divide_no_nan</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/losses/pytorch.py#L10" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>divide_no_nan</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>)</p>
</blockquote>
<p>Auxiliary funtion to handle divide by 0</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MAPELoss" class="doc_header"><code>MAPELoss</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/losses/pytorch.py#L23" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MAPELoss</code>(<strong><code>y</code></strong>, <strong><code>y_hat</code></strong>, <strong><code>mask</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>MAPE Loss</p>
<p>Calculates Mean Absolute Percentage Error between
y and y_hat. MAPE measures the relative prediction
accuracy of a forecasting method by calculating the
percentual deviation of the prediction and the true
value at a given time and averages these devations
over the length of the series.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>y: tensor (batch_size, output_size)
    actual values in torch tensor.
y_hat: tensor (batch_size, output_size)
    predicted values in torch tensor.
mask: tensor (batch_size, output_size)
    specifies date stamps per serie
    to consider in loss</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>mape:
Mean absolute percentage error.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MSELoss" class="doc_header"><code>MSELoss</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/losses/pytorch.py#L65" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MSELoss</code>(<strong><code>y</code></strong>, <strong><code>y_hat</code></strong>, <strong><code>mask</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>MSE Loss</p>
<p>Calculates Mean Squared Error between
y and y_hat. MAPE measures the relative prediction
accuracy of a forecasting method by calculating the
percentual deviation of the prediction and the true
value at a given time and averages these devations
over the length of the series.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>y: tensor (batch_size, output_size)
    actual values in torch tensor.
y_hat: tensor (batch_size, output_size)
    predicted values in torch tensor.
mask: tensor (batch_size, output_size)
    specifies date stamps per serie
    to consider in loss</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>mse:
Mean Squared Error.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="SMAPELoss" class="doc_header"><code>SMAPELoss</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/losses/pytorch.py#L95" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>SMAPELoss</code>(<strong><code>y</code></strong>, <strong><code>y_hat</code></strong>, <strong><code>mask</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>SMAPE2 Loss</p>
<p>Calculates Symmetric Mean Absolute Percentage Error.
SMAPE measures the relative prediction accuracy of a
forecasting method by calculating the relative deviation
of the prediction and the true value scaled by the sum of the
absolute values for the prediction and true value at a
given time, then averages these devations over the length
of the series. This allows the SMAPE to have bounds between
0% and 200% which is desireble compared to normal MAPE that
may be undetermined.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>y: tensor (batch_size, output_size)
    actual values in torch tensor.
y_hat: tensor (batch_size, output_size)
    predicted values in torch tensor.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>smape:
    symmetric mean absolute percentage error</p>
<h2 id="References">References<a class="anchor-link" href="#References"> </a></h2><p>[1] <a href="https://robjhyndman.com/hyndsight/smape/">https://robjhyndman.com/hyndsight/smape/</a> (Makridakis 1993)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MASELoss" class="doc_header"><code>MASELoss</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/losses/pytorch.py#L134" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MASELoss</code>(<strong><code>y</code></strong>, <strong><code>y_hat</code></strong>, <strong><code>y_insample</code></strong>, <strong><code>seasonality</code></strong>, <strong><code>mask</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculates the M4 Mean Absolute Scaled Error.</p>
<p>MASE measures the relative prediction accuracy of a
forecasting method by comparinng the mean absolute errors
of the prediction and the true value against the mean
absolute errors of the seasonal naive model.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>seasonality: int
    main frequency of the time series
    Hourly 24,  Daily 7, Weekly 52,
    Monthly 12, Quarterly 4, Yearly 1
y: tensor (batch_size, output_size)
    actual test values
y_hat: tensor (batch_size, output_size)
    predicted values
y_train: tensor (batch_size, input_size)
    actual insample values for Seasonal Naive predictions</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>mase:
    mean absolute scaled error</p>
<h2 id="References">References<a class="anchor-link" href="#References"> </a></h2><p>[1] <a href="https://robjhyndman.com/papers/mase.pdf">https://robjhyndman.com/papers/mase.pdf</a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MAELoss" class="doc_header"><code>MAELoss</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/losses/pytorch.py#L174" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MAELoss</code>(<strong><code>y</code></strong>, <strong><code>y_hat</code></strong>, <strong><code>mask</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>MAE Loss</p>
<p>Calculates Mean Absolute Error between
y and y_hat. MAE measures the relative prediction
accuracy of a forecasting method by calculating the
deviation of the prediction and the true
value at a given time and averages these devations
over the length of the series.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>y: tensor (batch_size, output_size)
    actual values in torch tensor.
y_hat: tensor (batch_size, output_size)
    predicted values in torch tensor.
mask: tensor (batch_size, output_size)
    specifies date stamps per serie
    to consider in loss</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>mae:
Mean absolute error.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="PinballLoss" class="doc_header"><code>PinballLoss</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/losses/pytorch.py#L203" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>PinballLoss</code>(<strong><code>y</code></strong>, <strong><code>y_hat</code></strong>, <strong><code>mask</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Pinball Loss
Computes the pinball loss between y and y_hat.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>y: tensor (batch_size, output_size)
    actual values in torch tensor.
y_hat: tensor (batch_size, output_size)
    predicted values in torch tensor.
tau: float, between 0 and 1
    the slope of the pinball loss, in the context of
    quantile regression, the value of tau determines the
    conditional quantile level.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>pinball:
    average accuracy for the predicted quantile</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

