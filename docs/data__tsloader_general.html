---

title: TOY EXAMPLE


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/data__tsloader_general.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/data__tsloader_general.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TimeSeriesLoader" class="doc_header"><code>class</code> <code>TimeSeriesLoader</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/data/tsloader_general.py#L17" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TimeSeriesLoader</code>(<strong><code>ts_dataset</code></strong>:<a href="/nixtla/data__tsdataset.html#TimeSeriesDataset"><code>TimeSeriesDataset</code></a>, <strong><code>model</code></strong>:<code>str</code>, <strong><code>offset</code></strong>:<code>int</code>, <strong><code>window_sampling_limit</code></strong>:<code>int</code>, <strong><code>input_size</code></strong>:<code>int</code>, <strong><code>output_size</code></strong>:<code>int</code>, <strong><code>idx_to_sample_freq</code></strong>:<code>int</code>, <strong><code>batch_size</code></strong>:<code>int</code>, <strong><code>complete_inputs</code></strong>:<code>bool</code>, <strong><code>complete_sample</code></strong>:<code>bool</code>, <strong><code>shuffle</code></strong>:<code>bool</code>, <strong><code>n_series_per_batch</code></strong>:<code>int</code>=<em><code>None</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">nixtla.data.datasets.m4</span> <span class="kn">import</span> <span class="n">M4</span><span class="p">,</span> <span class="n">M4Info</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M4Info</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">Y_df</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">M4</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;../data&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">M4Info</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Yearly
25.4MiB [00:01, 17.3MiB/s]
ERROR:nixtla.data.datasets.utils:ERROR, something went wrong downloading data
INFO:nixtla.data.datasets.utils:Successfully downloaded Yearly-train.csv, 25355736, bytes.
1.49MiB [00:00, 3.79MiB/s]
ERROR:nixtla.data.datasets.utils:ERROR, something went wrong downloading data
INFO:nixtla.data.datasets.utils:Successfully downloaded Yearly-test.csv, 1486434, bytes.
38.8MiB [00:04, 8.98MiB/s]
ERROR:nixtla.data.datasets.utils:ERROR, something went wrong downloading data
INFO:nixtla.data.datasets.utils:Successfully downloaded Quarterly-train.csv, 38788547, bytes.
1.97MiB [00:00, 2.82MiB/s]
ERROR:nixtla.data.datasets.utils:ERROR, something went wrong downloading data
INFO:nixtla.data.datasets.utils:Successfully downloaded Quarterly-test.csv, 1971754, bytes.
91.7MiB [00:11, 7.70MiB/s]
ERROR:nixtla.data.datasets.utils:ERROR, something went wrong downloading data
INFO:nixtla.data.datasets.utils:Successfully downloaded Monthly-train.csv, 91655432, bytes.
7.94MiB [00:01, 6.65MiB/s]
ERROR:nixtla.data.datasets.utils:ERROR, something went wrong downloading data
INFO:nixtla.data.datasets.utils:Successfully downloaded Monthly-test.csv, 7942698, bytes.
4.02MiB [00:00, 5.60MiB/s]
ERROR:nixtla.data.datasets.utils:ERROR, something went wrong downloading data
INFO:nixtla.data.datasets.utils:Successfully downloaded Weekly-train.csv, 4015067, bytes.
44.2kiB [00:00, 4.18MiB/s]                  
ERROR:nixtla.data.datasets.utils:ERROR, something went wrong downloading data
INFO:nixtla.data.datasets.utils:Successfully downloaded Weekly-test.csv, 44247, bytes.
95.8MiB [00:12, 7.70MiB/s]
ERROR:nixtla.data.datasets.utils:ERROR, something went wrong downloading data
INFO:nixtla.data.datasets.utils:Successfully downloaded Daily-train.csv, 95765153, bytes.
576kiB [00:00, 8.21MiB/s]                  
ERROR:nixtla.data.datasets.utils:ERROR, something went wrong downloading data
INFO:nixtla.data.datasets.utils:Successfully downloaded Daily-test.csv, 576459, bytes.
2.35MiB [00:00, 12.7MiB/s]
ERROR:nixtla.data.datasets.utils:ERROR, something went wrong downloading data
INFO:nixtla.data.datasets.utils:Successfully downloaded Hourly-train.csv, 2347115, bytes.
133kiB [00:00, 6.39MiB/s]                   
ERROR:nixtla.data.datasets.utils:ERROR, something went wrong downloading data
INFO:nixtla.data.datasets.utils:Successfully downloaded Hourly-test.csv, 132820, bytes.
100%|██████████| 14.0/14.0 [00:00&lt;00:00, 4.70kiB/s]
INFO:nixtla.data.datasets.utils:Successfully downloaded Other-train.csv, 14, bytes.
100%|██████████| 14.0/14.0 [00:00&lt;00:00, 5.78kiB/s]
INFO:nixtla.data.datasets.utils:Successfully downloaded Other-test.csv, 14, bytes.
4.34MiB [00:00, 30.0MiB/s]
ERROR:nixtla.data.datasets.utils:ERROR, something went wrong downloading data
INFO:nixtla.data.datasets.utils:Successfully downloaded M4-info.csv, 4335598, bytes.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m4_dataset</span> <span class="o">=</span> <span class="n">TimeSeriesDataset</span><span class="p">(</span><span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">mask_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ts_in_test</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m4_dataset</span><span class="o">.</span><span class="n">ts_tensor</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(23000, 3, 841)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">TimeSeriesLoader</span><span class="p">(</span><span class="n">ts_dataset</span><span class="o">=</span><span class="n">m4_dataset</span><span class="p">,</span>
                                <span class="n">model</span><span class="o">=</span><span class="s1">&#39;nbeats&#39;</span><span class="p">,</span>
                                <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                <span class="n">window_sampling_limit</span><span class="o">=</span><span class="n">m4_dataset</span><span class="o">.</span><span class="n">max_len</span><span class="p">,</span> 
                                <span class="n">input_size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="mi">6</span><span class="p">),</span>
                                <span class="n">output_size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
                                <span class="n">idx_to_sample_freq</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                                <span class="n">batch_size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
                                <span class="n">complete_inputs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">complete_sample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input_size</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">output_size</span> <span class="o">=</span> <span class="mi">6</span>

<span class="c1"># For shuffle bool testing purpose</span>
<span class="n">tensor</span><span class="p">,</span><span class="n">right_padding</span> <span class="o">=</span> <span class="n">m4_dataset</span><span class="o">.</span><span class="n">get_filtered_ts_tensor</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="n">output_size</span><span class="p">,</span>
                                                         <span class="n">window_sampling_limit</span><span class="o">=</span><span class="n">m4_dataset</span><span class="o">.</span><span class="n">max_len</span><span class="p">,</span>
                                                         <span class="n">ts_idxs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">23000</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataloader</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span>
<span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
<span class="n">insample_y</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;insample_y&#39;</span><span class="p">]</span>
<span class="n">insample_x_t</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;insample_x&#39;</span><span class="p">]</span>
<span class="n">insample_mask</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;insample_mask&#39;</span><span class="p">]</span>
<span class="n">outsample_y</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;outsample_y&#39;</span><span class="p">]</span>
<span class="n">outsample_x</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;outsample_x&#39;</span><span class="p">]</span>
<span class="n">outsample_mask</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;outsample_mask&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;insample_y.shape&quot;</span><span class="p">,</span> <span class="n">insample_y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;outsample_y.shape&quot;</span><span class="p">,</span> <span class="n">outsample_y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tensor.shape&quot;</span><span class="p">,</span> <span class="n">tensor</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>insample_y.shape torch.Size([30352, 30])
outsample_y.shape torch.Size([30352, 6])
tensor.shape (23000, 3, 841)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">insample_y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[   0.0000,    0.0000,    0.0000,  ...,    0.0000,    0.0000,
         5172.1001],
        [   0.0000,    0.0000,    0.0000,  ...,    0.0000, 5172.1001,
         5133.5000],
        [   0.0000,    0.0000,    0.0000,  ..., 5172.1001, 5133.5000,
         5186.8999],
        ...,
        [1870.0000, 2130.0000, 2030.0000,  ..., 4838.0000, 4901.0000,
         4976.0000],
        [2130.0000, 2030.0000, 2108.0000,  ..., 4901.0000, 4976.0000,
         5080.0000],
        [2030.0000, 2108.0000, 2265.0000,  ..., 4976.0000, 5080.0000,
         5073.0000]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">outsample_y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[5133.5000, 5186.8999, 5084.6001, 5182.0000, 5414.2998, 5576.2002],
        [5186.8999, 5084.6001, 5182.0000, 5414.2998, 5576.2002, 5752.8999],
        [5084.6001, 5182.0000, 5414.2998, 5576.2002, 5752.8999, 5955.2002],
        ...,
        [5080.0000, 5073.0000, 5116.0000, 4937.0000, 4994.0000, 4897.0000],
        [5073.0000, 5116.0000, 4937.0000, 4994.0000, 4897.0000, 4916.0000],
        [5116.0000, 4937.0000, 4994.0000, 4897.0000, 4916.0000, 4813.0000]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_loader</span><span class="o">.</span><span class="n">shuffle</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span>
<span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
<span class="n">insample_y</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;insample_y&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Checking order for unshuffled validation&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">insample_y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tensor</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Checking order for unshuffled validation
</pre>
</div>
</div>

<div class="output_area">


<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Created with matplotlib (https://matplotlib.org/) -->
<svg height="248.518125pt" version="1.1" viewBox="0 0 383.289616 248.518125" width="383.289616pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
 <metadata>
  <rdf:RDF xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
   <cc:Work>
    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>
    <dc:date>2021-02-16T21:03:42.432407</dc:date>
    <dc:format>image/svg+xml</dc:format>
    <dc:creator>
     <cc:Agent>
      <dc:title>Matplotlib v3.3.1, https://matplotlib.org/</dc:title>
     </cc:Agent>
    </dc:creator>
   </cc:Work>
  </rdf:RDF>
 </metadata>
 <defs>
  <style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style>
 </defs>
 <g id="figure_1">
  <g id="patch_1">
   <path d="M -0 248.518125 
L 383.289616 248.518125 
L 383.289616 0 
L -0 0 
z
" style="fill:none;"/>
  </g>
  <g id="axes_1">
   <g id="patch_2">
    <path d="M 39.65 224.64 
L 374.45 224.64 
L 374.45 7.2 
L 39.65 7.2 
z
" style="fill:#ffffff;"/>
   </g>
   <g id="matplotlib.axis_1">
    <g id="xtick_1">
     <g id="line2d_1">
      <defs>
       <path d="M 0 0 
L 0 3.5 
" id="m4d73503b08" style="stroke:#000000;stroke-width:0.8;"/>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="54.868182" xlink:href="#m4d73503b08" y="224.64"/>
      </g>
     </g>
     <g id="text_1">
      <!-- 0 -->
      <g transform="translate(51.686932 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"/>
       </defs>
       <use xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="xtick_2">
     <g id="line2d_2">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="107.344671" xlink:href="#m4d73503b08" y="224.64"/>
      </g>
     </g>
     <g id="text_2">
      <!-- 5 -->
      <g transform="translate(104.163421 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"/>
       </defs>
       <use xlink:href="#DejaVuSans-53"/>
      </g>
     </g>
    </g>
    <g id="xtick_3">
     <g id="line2d_3">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="159.82116" xlink:href="#m4d73503b08" y="224.64"/>
      </g>
     </g>
     <g id="text_3">
      <!-- 10 -->
      <g transform="translate(153.45866 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"/>
       </defs>
       <use xlink:href="#DejaVuSans-49"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="xtick_4">
     <g id="line2d_4">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="212.297649" xlink:href="#m4d73503b08" y="224.64"/>
      </g>
     </g>
     <g id="text_4">
      <!-- 15 -->
      <g transform="translate(205.935149 239.238437)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-49"/>
       <use x="63.623047" xlink:href="#DejaVuSans-53"/>
      </g>
     </g>
    </g>
    <g id="xtick_5">
     <g id="line2d_5">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="264.774138" xlink:href="#m4d73503b08" y="224.64"/>
      </g>
     </g>
     <g id="text_5">
      <!-- 20 -->
      <g transform="translate(258.411638 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"/>
       </defs>
       <use xlink:href="#DejaVuSans-50"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="xtick_6">
     <g id="line2d_6">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="317.250627" xlink:href="#m4d73503b08" y="224.64"/>
      </g>
     </g>
     <g id="text_6">
      <!-- 25 -->
      <g transform="translate(310.888127 239.238437)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-50"/>
       <use x="63.623047" xlink:href="#DejaVuSans-53"/>
      </g>
     </g>
    </g>
    <g id="xtick_7">
     <g id="line2d_7">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="369.727116" xlink:href="#m4d73503b08" y="224.64"/>
      </g>
     </g>
     <g id="text_7">
      <!-- 30 -->
      <g transform="translate(363.364616 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"/>
       </defs>
       <use xlink:href="#DejaVuSans-51"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
   </g>
   <g id="matplotlib.axis_2">
    <g id="ytick_1">
     <g id="line2d_8">
      <defs>
       <path d="M 0 0 
L -3.5 0 
" id="mb121283ad1" style="stroke:#000000;stroke-width:0.8;"/>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#mb121283ad1" y="214.756364"/>
      </g>
     </g>
     <g id="text_8">
      <!-- 0 -->
      <g transform="translate(26.2875 218.555582)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="ytick_2">
     <g id="line2d_9">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#mb121283ad1" y="176.537318"/>
      </g>
     </g>
     <g id="text_9">
      <!-- 1000 -->
      <g transform="translate(7.2 180.336537)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-49"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
       <use x="190.869141" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="ytick_3">
     <g id="line2d_10">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#mb121283ad1" y="138.318273"/>
      </g>
     </g>
     <g id="text_10">
      <!-- 2000 -->
      <g transform="translate(7.2 142.117492)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-50"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
       <use x="190.869141" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="ytick_4">
     <g id="line2d_11">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#mb121283ad1" y="100.099228"/>
      </g>
     </g>
     <g id="text_11">
      <!-- 3000 -->
      <g transform="translate(7.2 103.898447)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-51"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
       <use x="190.869141" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="ytick_5">
     <g id="line2d_12">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#mb121283ad1" y="61.880183"/>
      </g>
     </g>
     <g id="text_12">
      <!-- 4000 -->
      <g transform="translate(7.2 65.679402)scale(0.1 -0.1)">
       <defs>
        <path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"/>
       </defs>
       <use xlink:href="#DejaVuSans-52"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
       <use x="190.869141" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="ytick_6">
     <g id="line2d_13">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#mb121283ad1" y="23.661138"/>
      </g>
     </g>
     <g id="text_13">
      <!-- 5000 -->
      <g transform="translate(7.2 27.460357)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-53"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
       <use x="190.869141" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
   </g>
   <g id="line2d_14">
    <path clip-path="url(#p45a157aa6d)" d="M 54.868182 214.756364 
L 65.36348 214.756364 
L 75.858777 214.756364 
L 86.354075 214.756364 
L 96.849373 214.756364 
L 107.344671 214.756364 
L 117.839969 214.756364 
L 128.335266 214.756364 
L 138.830564 214.756364 
L 149.325862 214.756364 
L 159.82116 214.756364 
L 170.316458 214.756364 
L 180.811755 214.756364 
L 191.307053 214.756364 
L 201.802351 214.756364 
L 212.297649 214.756364 
L 222.792947 214.756364 
L 233.288245 214.756364 
L 243.783542 214.756364 
L 254.27884 214.756364 
L 264.774138 214.756364 
L 275.269436 214.756364 
L 285.764734 214.756364 
L 296.260031 214.756364 
L 306.755329 214.756364 
L 317.250627 214.756364 
L 327.745925 214.756364 
L 338.241223 214.756364 
L 348.73652 214.756364 
L 359.231818 17.083636 
" style="fill:none;stroke:#1f77b4;stroke-linecap:square;stroke-width:1.5;"/>
   </g>
   <g id="patch_3">
    <path d="M 39.65 224.64 
L 39.65 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"/>
   </g>
   <g id="patch_4">
    <path d="M 374.45 224.64 
L 374.45 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"/>
   </g>
   <g id="patch_5">
    <path d="M 39.65 224.64 
L 374.45 224.64 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"/>
   </g>
   <g id="patch_6">
    <path d="M 39.65 7.2 
L 374.45 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"/>
   </g>
  </g>
 </g>
 <defs>
  <clipPath id="p45a157aa6d">
   <rect height="217.44" width="334.8" x="39.65" y="7.2"/>
  </clipPath>
 </defs>
</svg>

</div>

</div>

<div class="output_area">


<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Created with matplotlib (https://matplotlib.org/) -->
<svg height="248.518125pt" version="1.1" viewBox="0 0 381.65 248.518125" width="381.65pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
 <metadata>
  <rdf:RDF xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
   <cc:Work>
    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>
    <dc:date>2021-02-16T21:03:42.639450</dc:date>
    <dc:format>image/svg+xml</dc:format>
    <dc:creator>
     <cc:Agent>
      <dc:title>Matplotlib v3.3.1, https://matplotlib.org/</dc:title>
     </cc:Agent>
    </dc:creator>
   </cc:Work>
  </rdf:RDF>
 </metadata>
 <defs>
  <style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style>
 </defs>
 <g id="figure_1">
  <g id="patch_1">
   <path d="M -0 248.518125 
L 381.65 248.518125 
L 381.65 0 
L -0 0 
z
" style="fill:none;"/>
  </g>
  <g id="axes_1">
   <g id="patch_2">
    <path d="M 39.65 224.64 
L 374.45 224.64 
L 374.45 7.2 
L 39.65 7.2 
z
" style="fill:#ffffff;"/>
   </g>
   <g id="matplotlib.axis_1">
    <g id="xtick_1">
     <g id="line2d_1">
      <defs>
       <path d="M 0 0 
L 0 3.5 
" id="m0c44ea6e7a" style="stroke:#000000;stroke-width:0.8;"/>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="54.868182" xlink:href="#m0c44ea6e7a" y="224.64"/>
      </g>
     </g>
     <g id="text_1">
      <!-- 0 -->
      <g transform="translate(51.686932 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"/>
       </defs>
       <use xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="xtick_2">
     <g id="line2d_2">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="127.335714" xlink:href="#m0c44ea6e7a" y="224.64"/>
      </g>
     </g>
     <g id="text_2">
      <!-- 200 -->
      <g transform="translate(117.791964 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"/>
       </defs>
       <use xlink:href="#DejaVuSans-50"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="xtick_3">
     <g id="line2d_3">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="199.803247" xlink:href="#m0c44ea6e7a" y="224.64"/>
      </g>
     </g>
     <g id="text_3">
      <!-- 400 -->
      <g transform="translate(190.259497 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"/>
       </defs>
       <use xlink:href="#DejaVuSans-52"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="xtick_4">
     <g id="line2d_4">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="272.270779" xlink:href="#m0c44ea6e7a" y="224.64"/>
      </g>
     </g>
     <g id="text_4">
      <!-- 600 -->
      <g transform="translate(262.727029 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"/>
       </defs>
       <use xlink:href="#DejaVuSans-54"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="xtick_5">
     <g id="line2d_5">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="344.738312" xlink:href="#m0c44ea6e7a" y="224.64"/>
      </g>
     </g>
     <g id="text_5">
      <!-- 800 -->
      <g transform="translate(335.194562 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"/>
       </defs>
       <use xlink:href="#DejaVuSans-56"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
   </g>
   <g id="matplotlib.axis_2">
    <g id="ytick_1">
     <g id="line2d_6">
      <defs>
       <path d="M 0 0 
L -3.5 0 
" id="m85556f4b5a" style="stroke:#000000;stroke-width:0.8;"/>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#m85556f4b5a" y="214.756364"/>
      </g>
     </g>
     <g id="text_6">
      <!-- 0 -->
      <g transform="translate(26.2875 218.555582)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="ytick_2">
     <g id="line2d_7">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#m85556f4b5a" y="189.488861"/>
      </g>
     </g>
     <g id="text_7">
      <!-- 1000 -->
      <g transform="translate(7.2 193.28808)scale(0.1 -0.1)">
       <defs>
        <path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"/>
       </defs>
       <use xlink:href="#DejaVuSans-49"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
       <use x="190.869141" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="ytick_3">
     <g id="line2d_8">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#m85556f4b5a" y="164.221358"/>
      </g>
     </g>
     <g id="text_8">
      <!-- 2000 -->
      <g transform="translate(7.2 168.020577)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-50"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
       <use x="190.869141" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="ytick_4">
     <g id="line2d_9">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#m85556f4b5a" y="138.953855"/>
      </g>
     </g>
     <g id="text_9">
      <!-- 3000 -->
      <g transform="translate(7.2 142.753074)scale(0.1 -0.1)">
       <defs>
        <path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"/>
       </defs>
       <use xlink:href="#DejaVuSans-51"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
       <use x="190.869141" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="ytick_5">
     <g id="line2d_10">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#m85556f4b5a" y="113.686353"/>
      </g>
     </g>
     <g id="text_10">
      <!-- 4000 -->
      <g transform="translate(7.2 117.485572)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-52"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
       <use x="190.869141" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="ytick_6">
     <g id="line2d_11">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#m85556f4b5a" y="88.41885"/>
      </g>
     </g>
     <g id="text_11">
      <!-- 5000 -->
      <g transform="translate(7.2 92.218069)scale(0.1 -0.1)">
       <defs>
        <path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"/>
       </defs>
       <use xlink:href="#DejaVuSans-53"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
       <use x="190.869141" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="ytick_7">
     <g id="line2d_12">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#m85556f4b5a" y="63.151347"/>
      </g>
     </g>
     <g id="text_12">
      <!-- 6000 -->
      <g transform="translate(7.2 66.950566)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-54"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
       <use x="190.869141" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="ytick_8">
     <g id="line2d_13">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#m85556f4b5a" y="37.883845"/>
      </g>
     </g>
     <g id="text_13">
      <!-- 7000 -->
      <g transform="translate(7.2 41.683063)scale(0.1 -0.1)">
       <defs>
        <path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"/>
       </defs>
       <use xlink:href="#DejaVuSans-55"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
       <use x="190.869141" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="ytick_9">
     <g id="line2d_14">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="39.65" xlink:href="#m85556f4b5a" y="12.616342"/>
      </g>
     </g>
     <g id="text_14">
      <!-- 8000 -->
      <g transform="translate(7.2 16.415561)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-56"/>
       <use x="63.623047" xlink:href="#DejaVuSans-48"/>
       <use x="127.246094" xlink:href="#DejaVuSans-48"/>
       <use x="190.869141" xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
   </g>
   <g id="line2d_15">
    <path clip-path="url(#p419077bf20)" d="M 54.868182 214.756364 
L 345.825325 214.756364 
L 346.187662 84.070313 
L 346.55 85.045638 
L 346.912338 83.696354 
L 347.274675 86.281219 
L 347.637013 83.820165 
L 348.361688 73.859715 
L 349.811039 57.114941 
L 350.173377 55.136495 
L 350.535714 56.513574 
L 350.898052 54.029779 
L 351.26039 52.352017 
L 351.985065 42.042876 
L 352.347403 39.766274 
L 352.70974 36.026683 
L 353.434416 32.057158 
L 353.796753 29.050326 
L 354.159091 29.313108 
L 354.521429 31.546755 
L 354.883766 30.440038 
L 355.246104 27.930975 
L 355.608442 23.711302 
L 355.970779 21.424593 
L 356.695455 24.479434 
L 357.057792 31.2865 
L 357.42013 30.551215 
L 357.782468 27.963823 
L 358.144805 24.55271 
L 358.507143 22.854734 
L 359.231818 17.083636 
L 359.231818 17.083636 
" style="fill:none;stroke:#1f77b4;stroke-linecap:square;stroke-width:1.5;"/>
   </g>
   <g id="patch_3">
    <path d="M 39.65 224.64 
L 39.65 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"/>
   </g>
   <g id="patch_4">
    <path d="M 374.45 224.64 
L 374.45 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"/>
   </g>
   <g id="patch_5">
    <path d="M 39.65 224.64 
L 374.45 224.64 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"/>
   </g>
   <g id="patch_6">
    <path d="M 39.65 7.2 
L 374.45 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"/>
   </g>
  </g>
 </g>
 <defs>
  <clipPath id="p419077bf20">
   <rect height="217.44" width="334.8" x="39.65" y="7.2"/>
  </clipPath>
 </defs>
</svg>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">n_weeks</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">168</span><span class="o">*</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">168</span><span class="o">*</span><span class="mi">2</span><span class="p">))])</span>
<span class="n">X1</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">168</span><span class="o">*</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">168</span><span class="o">*</span><span class="mi">2</span><span class="p">))])</span>
<span class="n">X2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">168</span><span class="o">*</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">168</span><span class="o">*</span><span class="mi">2</span><span class="p">))])</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">unique_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;u1&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">168</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;u2&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">168</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;1/1/2018&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;1/15/2018&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="o">+</span> \
     <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;1/1/2018&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;1/15/2018&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="n">X_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;unique_id&#39;</span><span class="p">:</span> <span class="n">unique_id</span><span class="p">,</span> <span class="s1">&#39;ds&#39;</span><span class="p">:</span> <span class="n">ds</span><span class="p">,</span> <span class="s1">&#39;X1&#39;</span><span class="p">:</span> <span class="n">X1</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">:</span> <span class="n">X2</span><span class="p">})</span>
<span class="n">Y_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;unique_id&#39;</span><span class="p">:</span> <span class="n">unique_id</span><span class="p">,</span> <span class="s1">&#39;ds&#39;</span><span class="p">:</span> <span class="n">ds</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">Y</span><span class="p">})</span>
<span class="n">S_df</span> <span class="o">=</span> <span class="n">Y_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;unique_id&#39;</span><span class="p">)[[</span><span class="s1">&#39;unique_id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">S_df</span><span class="p">[</span><span class="s1">&#39;s_0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">S_df</span><span class="p">[</span><span class="s1">&#39;s_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Y_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique_id</th>
      <th>ds</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>u1</td>
      <td>2018-01-01 00:00:00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>u1</td>
      <td>2018-01-01 01:00:00</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>u1</td>
      <td>2018-01-01 02:00:00</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>u1</td>
      <td>2018-01-01 03:00:00</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>u1</td>
      <td>2018-01-01 04:00:00</td>
      <td>4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>667</th>
      <td>u2</td>
      <td>2018-01-14 19:00:00</td>
      <td>3310</td>
    </tr>
    <tr>
      <th>668</th>
      <td>u2</td>
      <td>2018-01-14 20:00:00</td>
      <td>3320</td>
    </tr>
    <tr>
      <th>669</th>
      <td>u2</td>
      <td>2018-01-14 21:00:00</td>
      <td>3330</td>
    </tr>
    <tr>
      <th>670</th>
      <td>u2</td>
      <td>2018-01-14 22:00:00</td>
      <td>3340</td>
    </tr>
    <tr>
      <th>671</th>
      <td>u2</td>
      <td>2018-01-14 23:00:00</td>
      <td>3350</td>
    </tr>
  </tbody>
</table>
<p>672 rows × 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">toy_dataset</span> <span class="o">=</span> <span class="n">TimeSeriesDataset</span><span class="p">(</span><span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="n">X_df</span><span class="p">,</span> <span class="n">S_df</span><span class="o">=</span><span class="n">S_df</span><span class="p">,</span> <span class="n">mask_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ts_in_test</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ts_loader</span> <span class="o">=</span> <span class="n">TimeSeriesLoader</span><span class="p">(</span><span class="n">ts_dataset</span><span class="o">=</span><span class="n">toy_dataset</span><span class="p">,</span>
                             <span class="n">model</span><span class="o">=</span><span class="s1">&#39;nbeats&#39;</span><span class="p">,</span>
                             <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                             <span class="n">window_sampling_limit</span><span class="o">=</span><span class="n">toy_dataset</span><span class="o">.</span><span class="n">max_len</span><span class="p">,</span>
                             <span class="n">input_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                             <span class="n">output_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                             <span class="n">idx_to_sample_freq</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
                             <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                             <span class="n">complete_inputs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                             <span class="n">complete_sample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                             <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataloader</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">ts_loader</span><span class="p">)</span>
<span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
<span class="n">insample_y</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;insample_y&#39;</span><span class="p">]</span>
<span class="n">insample_x_t</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;insample_x&#39;</span><span class="p">]</span>
<span class="n">insample_mask</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;insample_mask&#39;</span><span class="p">]</span>
<span class="n">outsample_y</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;outsample_y&#39;</span><span class="p">]</span>
<span class="n">outsample_x</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;outsample_x&#39;</span><span class="p">]</span>
<span class="n">outsample_mask</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;outsample_mask&#39;</span><span class="p">]</span>
<span class="n">s_matrix</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;s_matrix&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m4_dataset.t_cols&quot;</span><span class="p">,</span> <span class="n">m4_dataset</span><span class="o">.</span><span class="n">t_cols</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ts_loader.input_size&quot;</span><span class="p">,</span> <span class="n">ts_loader</span><span class="o">.</span><span class="n">input_size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ts_loader.output_size&quot;</span><span class="p">,</span> <span class="n">ts_loader</span><span class="o">.</span><span class="n">output_size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;insample_y.shape&quot;</span><span class="p">,</span> <span class="n">insample_y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;outsample_y.shape&quot;</span><span class="p">,</span> <span class="n">outsample_y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s_matrix.shape&quot;</span><span class="p">,</span> <span class="n">s_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>m4_dataset.t_cols [&#39;y&#39;, &#39;available_mask&#39;, &#39;sample_mask&#39;]
ts_loader.input_size 5
ts_loader.output_size 5
insample_y.shape torch.Size([26, 5])
outsample_y.shape torch.Size([26, 5])
s_matrix.shape (26, 2)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">insample_y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[  19.,   20.,   21.,   22.,   23.],
        [  43.,   44.,   45.,   46.,   47.],
        [  67.,   68.,   69.,   70.,   71.],
        [  91.,   92.,   93.,   94.,   95.],
        [ 115.,  116.,  117.,  118.,  119.],
        [ 139.,  140.,  141.,  142.,  143.],
        [ 163.,  164.,  165.,  166.,  167.],
        [ 187.,  188.,  189.,  190.,  191.],
        [ 211.,  212.,  213.,  214.,  215.],
        [ 235.,  236.,  237.,  238.,  239.],
        [ 259.,  260.,  261.,  262.,  263.],
        [ 283.,  284.,  285.,  286.,  287.],
        [ 307.,  308.,  309.,  310.,  311.],
        [ 190.,  200.,  210.,  220.,  230.],
        [ 430.,  440.,  450.,  460.,  470.],
        [ 670.,  680.,  690.,  700.,  710.],
        [ 910.,  920.,  930.,  940.,  950.],
        [1150., 1160., 1170., 1180., 1190.],
        [1390., 1400., 1410., 1420., 1430.],
        [1630., 1640., 1650., 1660., 1670.],
        [1870., 1880., 1890., 1900., 1910.],
        [2110., 2120., 2130., 2140., 2150.],
        [2350., 2360., 2370., 2380., 2390.],
        [2590., 2600., 2610., 2620., 2630.],
        [2830., 2840., 2850., 2860., 2870.],
        [3070., 3080., 3090., 3100., 3110.]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">outsample_y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[  24.,   25.,   26.,   27.,   28.],
        [  48.,   49.,   50.,   51.,   52.],
        [  72.,   73.,   74.,   75.,   76.],
        [  96.,   97.,   98.,   99.,  100.],
        [ 120.,  121.,  122.,  123.,  124.],
        [ 144.,  145.,  146.,  147.,  148.],
        [ 168.,  169.,  170.,  171.,  172.],
        [ 192.,  193.,  194.,  195.,  196.],
        [ 216.,  217.,  218.,  219.,  220.],
        [ 240.,  241.,  242.,  243.,  244.],
        [ 264.,  265.,  266.,  267.,  268.],
        [ 288.,  289.,  290.,  291.,  292.],
        [ 312.,  313.,  314.,  315.,  316.],
        [ 240.,  250.,  260.,  270.,  280.],
        [ 480.,  490.,  500.,  510.,  520.],
        [ 720.,  730.,  740.,  750.,  760.],
        [ 960.,  970.,  980.,  990., 1000.],
        [1200., 1210., 1220., 1230., 1240.],
        [1440., 1450., 1460., 1470., 1480.],
        [1680., 1690., 1700., 1710., 1720.],
        [1920., 1930., 1940., 1950., 1960.],
        [2160., 2170., 2180., 2190., 2200.],
        [2400., 2410., 2420., 2430., 2440.],
        [2640., 2650., 2660., 2670., 2680.],
        [2880., 2890., 2900., 2910., 2920.],
        [3120., 3130., 3140., 3150., 3160.]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s_matrix</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [0., 1.],
       [0., 1.],
       [0., 1.],
       [0., 1.],
       [0., 1.],
       [0., 1.],
       [0., 1.],
       [0., 1.],
       [0., 1.],
       [0., 1.],
       [0., 1.],
       [0., 1.],
       [0., 1.]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

