---

title: Experiment Utils


keywords: fastai
sidebar: home_sidebar

summary: "Set of functions to easily perform experiments."
description: "Set of functions to easily perform experiments."
nb_path: "nbs/experiments__utils.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/experiments__utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_mask_dfs" class="doc_header"><code>get_mask_dfs</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_mask_dfs</code>(<strong><code>Y_df</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>ds_in_test</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_random_mask_dfs" class="doc_header"><code>get_random_mask_dfs</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L64" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_random_mask_dfs</code>(<strong><code>Y_df</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>n_ds_val_window</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>freq</code></strong>)</p>
</blockquote>
<p>Generates train, test and random validation mask.
Train mask begins by avoiding ds_in_test</p>
<p>Validation mask: 1) samples n_uids unique ids
                 2) creates windows of size n_ds_val_window</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>ds_in_test: int
    Number of ds in test.
n_uids: int
    Number of unique ids in validation.
n_val_windows: int
    Number of windows for validation.
n_ds_val_window: int
    Number of ds in each validation window.
periods: int
    ds_in_test multiplier.
freq: str
    string that determines datestamp frequency, used in
    random windows creation.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="scale_data" class="doc_header"><code>scale_data</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L120" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>scale_data</code>(<strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>mask_df</code></strong>, <strong><code>normalizer_y</code></strong>, <strong><code>normalizer_x</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_datasets" class="doc_header"><code>create_datasets</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L138" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_datasets</code>(<strong><code>mc</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_loaders" class="doc_header"><code>instantiate_loaders</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L197" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_loaders</code>(<strong><code>mc</code></strong>, <strong><code>train_dataset</code></strong>, <strong><code>val_dataset</code></strong>, <strong><code>test_dataset</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_nbeats" class="doc_header"><code>instantiate_nbeats</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L219" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_nbeats</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_esrnn" class="doc_header"><code>instantiate_esrnn</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L253" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_esrnn</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_mqesrnn" class="doc_header"><code>instantiate_mqesrnn</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L285" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_mqesrnn</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_model" class="doc_header"><code>instantiate_model</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L314" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_model</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="model_fit_predict" class="doc_header"><code>model_fit_predict</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L321" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>model_fit_predict</code>(<strong><code>mc</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate_model" class="doc_header"><code>evaluate_model</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L376" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate_model</code>(<strong><code>mc</code></strong>, <strong><code>loss_function</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>, <strong><code>loss_kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hyperopt_tunning" class="doc_header"><code>hyperopt_tunning</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L423" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hyperopt_tunning</code>(<strong><code>space</code></strong>, <strong><code>hyperopt_max_evals</code></strong>, <strong><code>loss_function</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>, <strong><code>save_trials</code></strong>=<em><code>False</code></em>, <strong><code>loss_kwargs</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Experiment-Utils-Examples">Experiment Utils Examples<a class="anchor-link" href="#Experiment-Utils-Examples"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">t</span>
<span class="kn">from</span> <span class="nn">nixtla.losses.numpy</span> <span class="kn">import</span> <span class="n">mae</span><span class="p">,</span> <span class="n">mape</span><span class="p">,</span> <span class="n">smape</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">pinball_loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span>
<span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span> <span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span>  

<span class="n">nbeats_space</span><span class="o">=</span> <span class="p">{</span><span class="c1"># Architecture parameters</span>
               <span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;nbeats&#39;</span><span class="p">,</span>
               <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;simple&#39;</span><span class="p">,</span>
               <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">]),</span>
               <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;output_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;shared_weights&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;shared_weights&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;activation&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;SELU&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;initialization&#39;</span><span class="p">:</span>  <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;initialization&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;glorot_normal&#39;</span><span class="p">,</span><span class="s1">&#39;he_normal&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;stack_types&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;stack_types&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">],</span>
                                                        <span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">],</span>
                                                        <span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_blocks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_blocks&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_layers&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_layers&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_hidden&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_hidden&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">364</span> <span class="p">]),</span>
               <span class="s1">&#39;n_harmonics&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_harmonics&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;n_polynomials&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_polynomials&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
               <span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
               <span class="c1"># Regularization and optimization parameters</span>
               <span class="s1">&#39;batch_normalization&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_normalization&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
               <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)),</span>
               <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;lr_decay&#39;</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
               <span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
               <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;weight_decay&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-3</span><span class="p">)),</span>
               <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_iterations&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span> <span class="c1">#[args.max_epochs]),</span>
               <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;early_stopping&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">16</span><span class="p">]),</span>
               <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;eval_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;n_val_weeks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_val_weeks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">52</span><span class="o">*</span><span class="mi">2</span><span class="p">]),</span>
               <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;loss_hypar&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss_hypar&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]),</span>                
               <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span> <span class="c1">#[args.val_loss]),</span>
               <span class="s1">&#39;l1_theta&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;l1_theta&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
               <span class="c1"># Data parameters</span>
               <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_x&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;median&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100_000</span><span class="p">]),</span>
               <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_inputs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;complete_sample&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_sample&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>                
               <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;seasonality&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>      
               <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">256</span><span class="p">]),</span>
               <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;random_seed&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">device</span><span class="p">])}</span>

<span class="n">mc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;nbeats&#39;</span><span class="p">,</span>
      <span class="c1"># Architecture parameters</span>
      <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
      <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;shared_weights&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="s1">&#39;selu&#39;</span><span class="p">,</span>
      <span class="s1">&#39;initialization&#39;</span><span class="p">:</span> <span class="s1">&#39;he_normal&#39;</span><span class="p">,</span>
      <span class="s1">&#39;stack_types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">],</span>
      <span class="s1">&#39;n_blocks&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
      <span class="s1">&#39;n_layers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
      <span class="s1">&#39;n_hidden&#39;</span><span class="p">:</span> <span class="mi">364</span><span class="p">,</span>
      <span class="s1">&#39;n_polynomials&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s1">&#39;n_harmonics&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="c1"># Regularization and optimization parameters</span>
      <span class="s1">&#39;batch_normalization&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
      <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span> <span class="c1">#0.002,</span>
      <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="mf">0.64</span><span class="p">,</span>
      <span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.00015</span><span class="p">,</span>
      <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
      <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;n_val_weeks&#39;</span><span class="p">:</span> <span class="mi">52</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
      <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="s1">&#39;PINBALL&#39;</span><span class="p">,</span>
      <span class="s1">&#39;loss_hypar&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="c1">#0.49,</span>
      <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="s1">&#39;MAE&#39;</span><span class="p">,</span>
      <span class="s1">&#39;l1_theta&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="c1"># Data parameters</span>
      <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span>
      <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="mi">100_000</span><span class="p">,</span>
      <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;frequency&#39;</span><span class="p">:</span><span class="s1">&#39;H&#39;</span><span class="p">,</span>
      <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
      <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="s1">&#39;cpu&#39;</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">esrnn_space</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;esrnn&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;full&#39;</span><span class="p">,</span>
               <span class="c1"># Architecture parameters</span>
               <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">]),</span>
               <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;output_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;dilations&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;dilations&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">]]</span> <span class="p">]),</span>
               <span class="s1">&#39;es_component&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;es_component&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;multiplicative&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;cell_type&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;LSTM&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;state_hsize&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;state_hsize&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
               <span class="s1">&#39;add_nl_layer&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;add_nl_layer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;seasonality&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="p">]),</span>
               <span class="c1"># Regularization and optimization parameters</span>
               <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span><span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_iterations&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span><span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;early_stopping&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;eval_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">32</span><span class="p">]),</span>
               <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)),</span>
               <span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">]),</span>
               <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;lr_decay&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
               <span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]),</span>
               <span class="s1">&#39;gradient_eps&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;gradient_eps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1e-8</span><span class="p">]),</span>
               <span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0005</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">]),</span>
               <span class="s1">&#39;noise_std&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;noise_std&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)),</span>
               <span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
               <span class="s1">&#39;testing_percentile&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;testing_percentile&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;training_percentile&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;training_percentile&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">]),</span>
               <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;random_seed&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;SMYL&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span>
               <span class="c1"># Data parameters</span>
               <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">500_000</span><span class="p">]),</span>
               <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_inputs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">]),</span>
               <span class="s1">&#39;complete_sample&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_sample&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">]),</span>
               <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_x&#39;</span><span class="p">,</span>  <span class="p">[</span><span class="kc">None</span><span class="p">])}</span>

<span class="n">mc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;esrnn&#39;</span><span class="p">,</span>
      <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;full&#39;</span><span class="p">,</span>
      <span class="c1"># Architecture parameters</span>
      <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
      <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;dilations&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">]],</span>
      <span class="s1">&#39;es_component&#39;</span><span class="p">:</span> <span class="s1">&#39;multiplicative&#39;</span><span class="p">,</span>
      <span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;LSTM&#39;</span><span class="p">,</span>
      <span class="s1">&#39;state_hsize&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;add_nl_layer&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span>
      <span class="c1"># Regularization and optimization parameters</span>
      <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span><span class="c1">#00,</span>
      <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
      <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span>
      <span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
      <span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
      <span class="s1">&#39;gradient_eps&#39;</span><span class="p">:</span> <span class="mf">1e-8</span><span class="p">,</span> 
      <span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
      <span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
      <span class="s1">&#39;noise_std&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span>
      <span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;testing_percentile&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;training_percentile&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="s1">&#39;SMYL&#39;</span><span class="p">,</span>
      <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="s1">&#39;MAE&#39;</span><span class="p">,</span>
      <span class="c1"># Data parameters</span>
      <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="mi">500_000</span><span class="p">,</span>
      <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
      <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">instantiate_esrnn</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nixtla.data.datasets.epf</span> <span class="kn">import</span> <span class="n">EPF</span><span class="p">,</span> <span class="n">EPFInfo</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NP&#39;</span><span class="p">]</span>

<span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="p">,</span> <span class="n">S_df</span> <span class="o">=</span> <span class="n">EPF</span><span class="o">.</span><span class="n">load_groups</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>

<span class="n">X_df</span> <span class="o">=</span> <span class="n">X_df</span><span class="p">[[</span><span class="s1">&#39;unique_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;week_day&#39;</span><span class="p">]]</span>
<span class="n">Y_min</span> <span class="o">=</span> <span class="n">Y_df</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="c1">#Y_df.y = Y_df.y - Y_min + 20</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y_df</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">loss_function</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span> <span class="n">mc</span><span class="o">=</span><span class="n">mc</span><span class="p">,</span> 
                        <span class="n">S_df</span><span class="o">=</span><span class="n">S_df</span><span class="p">,</span> <span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="n">X_df</span><span class="p">,</span> <span class="n">f_cols</span><span class="o">=</span><span class="p">[],</span>
                        <span class="n">ds_in_test</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ds_in_val</span><span class="o">=</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span>
                        <span class="n">n_uids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_val_windows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">is_val_random</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loss_kwargs</span><span class="o">=</span><span class="p">{})</span>
<span class="n">result</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================

model                                   esrnn
mode                                     full
input_size_multiplier                       7
output_size                                24
dilations                       [[1, 2], [7]]
es_component                   multiplicative
cell_type                                LSTM
state_hsize                                50
add_nl_layer                            False
seasonality                              [24]
n_iterations                               10
early_stopping                             10
eval_freq                                  10
batch_size                                 32
learning_rate                          0.0005
lr_scheduler_step_size                    100
lr_decay                                  0.8
per_series_lr_multip                      1.5
gradient_eps                              0.0
gradient_clipping_threshold                20
rnn_weight_decay                          0.0
noise_std                              0.0005
level_variability_penalty                  10
testing_percentile                         50
training_percentile                        50
random_seed                                 1
loss                                     SMYL
val_loss                                  MAE
len_sample_chunks                         672
window_sampling_limit                  500000
complete_inputs                          True
idx_to_sample_freq                         24
val_idx_to_sample_freq                     24
n_series_per_batch                          1
normalizer_y                             None
normalizer_x                             None
dtype: object
===============================================

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>

============================== Start fitting ==============================
Step: 10, Time: 6.219, Insample SMYL: 0.06312, Outsample MAE: 3.53607
Step: 10, Time: 6.422, Insample SMYL: 0.06312, Outsample MAE: 3.53607
==============================  End fitting  ==============================


y_true.shape (#n_series, #n_fcds, #lt): (728, 24)
y_hat.shape (#n_series, #n_fcds, #lt): (728, 24)


</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;loss&#39;: 3.5360693937447265,
 &#39;mc&#39;: {&#39;model&#39;: &#39;esrnn&#39;,
  &#39;mode&#39;: &#39;full&#39;,
  &#39;input_size_multiplier&#39;: 7,
  &#39;output_size&#39;: 24,
  &#39;dilations&#39;: [[1, 2], [7]],
  &#39;es_component&#39;: &#39;multiplicative&#39;,
  &#39;cell_type&#39;: &#39;LSTM&#39;,
  &#39;state_hsize&#39;: 50,
  &#39;add_nl_layer&#39;: False,
  &#39;seasonality&#39;: [24],
  &#39;n_iterations&#39;: 10,
  &#39;early_stopping&#39;: 10,
  &#39;eval_freq&#39;: 10,
  &#39;batch_size&#39;: 32,
  &#39;learning_rate&#39;: 0.0005,
  &#39;lr_scheduler_step_size&#39;: 100,
  &#39;lr_decay&#39;: 0.8,
  &#39;per_series_lr_multip&#39;: 1.5,
  &#39;gradient_eps&#39;: 1e-08,
  &#39;gradient_clipping_threshold&#39;: 20,
  &#39;rnn_weight_decay&#39;: 0.0,
  &#39;noise_std&#39;: 0.0005,
  &#39;level_variability_penalty&#39;: 10,
  &#39;testing_percentile&#39;: 50,
  &#39;training_percentile&#39;: 50,
  &#39;random_seed&#39;: 1,
  &#39;loss&#39;: &#39;SMYL&#39;,
  &#39;val_loss&#39;: &#39;MAE&#39;,
  &#39;len_sample_chunks&#39;: 672,
  &#39;window_sampling_limit&#39;: 500000,
  &#39;complete_inputs&#39;: True,
  &#39;idx_to_sample_freq&#39;: 24,
  &#39;val_idx_to_sample_freq&#39;: 24,
  &#39;n_series_per_batch&#39;: 1,
  &#39;normalizer_y&#39;: None,
  &#39;normalizer_x&#39;: None,
  &#39;n_x&#39;: 1,
  &#39;n_s&#39;: 1},
 &#39;y_true&#39;: array([[24.08, 22.52, 20.13, ..., 28.37, 27.24, 25.73],
        [26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
        [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
        ...,
        [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
        [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
        [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]], dtype=float32),
 &#39;y_hat&#39;: array([[24.416437, 23.664509, 21.57994 , ..., 28.753296, 27.852144,
         24.895967],
        [24.161135, 23.453985, 21.419779, ..., 29.362555, 27.345453,
         24.827553],
        [27.023512, 27.39484 , 24.627672, ..., 32.612892, 30.117023,
         28.561502],
        ...,
        [47.81169 , 50.220284, 49.058144, ..., 52.906826, 49.20261 ,
         47.07197 ],
        [49.38406 , 51.88949 , 48.27706 , ..., 53.678288, 52.63609 ,
         49.57756 ],
        [50.253582, 53.310566, 51.86941 , ..., 56.32574 , 52.99989 ,
         49.390263]], dtype=float32),
 &#39;trajectories&#39;: {&#39;iteration&#39;: [10],
  &#39;train_loss&#39;: [0.06311891227960587],
  &#39;val_loss&#39;: [3.5360696]},
 &#39;run_time&#39;: 11.874982357025146,
 &#39;status&#39;: &#39;ok&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;y_hat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fab44fadd90&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trials</span> <span class="o">=</span> <span class="n">hyperopt_tunning</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">nbeats_space</span><span class="p">,</span> <span class="n">hyperopt_max_evals</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">loss_function</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span>
                          <span class="n">S_df</span><span class="o">=</span><span class="n">S_df</span><span class="p">,</span> <span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="n">X_df</span><span class="p">,</span> <span class="n">f_cols</span><span class="o">=</span><span class="p">[],</span>
                          <span class="n">ds_in_val</span><span class="o">=</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span> <span class="n">n_uids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_val_windows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">is_val_random</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loss_kwargs</span><span class="o">=</span><span class="p">{})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>  0%|          | 0/2 [00:00&lt;?, ?trial/s, best loss=?]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:hyperopt.tpe:build_posterior_wrapper took 0.012561 seconds
INFO:hyperopt.tpe:TPE using 0 trials
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================      

activation                                     SELU  
batch_normalization                           False
batch_size                                      256
complete_inputs                               False
complete_sample                               False
device                                         cuda
dropout_prob_theta                         0.438016
early_stopping                                   16
eval_freq                                        50
exogenous_n_channels                            7.0
frequency                                         H
idx_to_sample_freq                               24
initialization                            he_normal
input_size_multiplier                             7
l1_theta                                          0
learning_rate                              0.000897
len_sample_chunks                              None
loss                                            MAE
loss_hypar                                      0.5
lr_decay                                   0.475166
mode                                         simple
model                                        nbeats
n_blocks                                     (1, 1)
n_harmonics                                       1
n_hidden                                        364
n_iterations                                     10
n_layers                                     (2, 2)
n_lr_decay_steps                                  3
n_polynomials                                     2
n_series_per_batch                                1
n_val_weeks                                     104
normalizer_x                                 median
normalizer_y                                   None
output_size                                      24
random_seed                                    15.0
seasonality                                      24
shared_weights                                False
stack_types               (exogenous_tcn, identity)
val_idx_to_sample_freq                           24
val_loss                                        MAE
weight_decay                               0.000654
window_sampling_limit                        100000
x_s_n_hidden                                      0
dtype: object
===============================================      

  0%|          | 0/2 [00:00&lt;?, ?trial/s, best loss=?]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>============================== Start fitting ==============================
Step: 10, Time: 0.322, Insample MAE: 24.23899, Outsample MAE: 5.79735
==============================  End fitting  ==============================
y_true.shape (#n_series, #n_fcds, #lt): (1, 728, 24) 
y_hat.shape (#n_series, #n_fcds, #lt): (1, 728, 24)  
 50%|█████     | 1/2 [00:02&lt;00:02,  2.05s/trial, best loss: 5.7973527908325195]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:hyperopt.tpe:build_posterior_wrapper took 0.032320 seconds
INFO:hyperopt.tpe:TPE using 1/1 trials with best loss 5.797353
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================                                

activation                                     SELU                            
batch_normalization                           False
batch_size                                      256
complete_inputs                               False
complete_sample                               False
device                                         cuda
dropout_prob_theta                         0.113913
early_stopping                                   16
eval_freq                                        50
exogenous_n_channels                           10.0
frequency                                         H
idx_to_sample_freq                               24
initialization                        glorot_normal
input_size_multiplier                             7
l1_theta                                          0
learning_rate                              0.000512
len_sample_chunks                              None
loss                                            MAE
loss_hypar                                      0.5
lr_decay                                   0.499117
mode                                         simple
model                                        nbeats
n_blocks                                     (1, 1)
n_harmonics                                       1
n_hidden                                        364
n_iterations                                     10
n_layers                                     (2, 2)
n_lr_decay_steps                                  3
n_polynomials                                     2
n_series_per_batch                                1
n_val_weeks                                     104
normalizer_x                                 median
normalizer_y                                   None
output_size                                      24
random_seed                                    16.0
seasonality                                      24
shared_weights                                False
stack_types               (exogenous_tcn, identity)
val_idx_to_sample_freq                           24
val_loss                                        MAE
weight_decay                               0.000086
window_sampling_limit                        100000
x_s_n_hidden                                      0
dtype: object
===============================================                                

 50%|█████     | 1/2 [00:02&lt;00:02,  2.05s/trial, best loss: 5.7973527908325195]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>============================== Start fitting ==============================    
Step: 10, Time: 0.291, Insample MAE: 10.26156, Outsample MAE: 5.98069          
==============================  End fitting  ==============================    
y_true.shape (#n_series, #n_fcds, #lt): (1, 728, 24)                           
y_hat.shape (#n_series, #n_fcds, #lt): (1, 728, 24)                            
100%|██████████| 2/2 [00:04&lt;00:00,  2.07s/trial, best loss: 5.7973527908325195]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trials</span><span class="o">.</span><span class="n">trials</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;state&#39;: 2,
  &#39;tid&#39;: 0,
  &#39;spec&#39;: None,
  &#39;result&#39;: {&#39;loss&#39;: 5.7973527908325195,
   &#39;mc&#39;: {&#39;activation&#39;: &#39;SELU&#39;,
    &#39;batch_normalization&#39;: False,
    &#39;batch_size&#39;: 256,
    &#39;complete_inputs&#39;: False,
    &#39;complete_sample&#39;: False,
    &#39;device&#39;: &#39;cuda&#39;,
    &#39;dropout_prob_theta&#39;: 0.43801632384236966,
    &#39;early_stopping&#39;: 16,
    &#39;eval_freq&#39;: 50,
    &#39;exogenous_n_channels&#39;: 7.0,
    &#39;frequency&#39;: &#39;H&#39;,
    &#39;idx_to_sample_freq&#39;: 24,
    &#39;initialization&#39;: &#39;he_normal&#39;,
    &#39;input_size_multiplier&#39;: 7,
    &#39;l1_theta&#39;: 0,
    &#39;learning_rate&#39;: 0.0008972627305368071,
    &#39;len_sample_chunks&#39;: None,
    &#39;loss&#39;: &#39;MAE&#39;,
    &#39;loss_hypar&#39;: 0.5,
    &#39;lr_decay&#39;: 0.47516554340200984,
    &#39;mode&#39;: &#39;simple&#39;,
    &#39;model&#39;: &#39;nbeats&#39;,
    &#39;n_blocks&#39;: (1, 1),
    &#39;n_harmonics&#39;: 1,
    &#39;n_hidden&#39;: 364,
    &#39;n_iterations&#39;: 10,
    &#39;n_layers&#39;: (2, 2),
    &#39;n_lr_decay_steps&#39;: 3,
    &#39;n_polynomials&#39;: 2,
    &#39;n_series_per_batch&#39;: 1,
    &#39;n_val_weeks&#39;: 104,
    &#39;normalizer_x&#39;: &#39;median&#39;,
    &#39;normalizer_y&#39;: None,
    &#39;output_size&#39;: 24,
    &#39;random_seed&#39;: 15.0,
    &#39;seasonality&#39;: 24,
    &#39;shared_weights&#39;: False,
    &#39;stack_types&#39;: (&#39;exogenous_tcn&#39;, &#39;identity&#39;),
    &#39;val_idx_to_sample_freq&#39;: 24,
    &#39;val_loss&#39;: &#39;MAE&#39;,
    &#39;weight_decay&#39;: 0.000654293943235604,
    &#39;window_sampling_limit&#39;: 100000,
    &#39;x_s_n_hidden&#39;: 0,
    &#39;n_x&#39;: 1,
    &#39;n_s&#39;: 1,
    &#39;n_hidden_list&#39;: [[364, 364], [364, 364]]},
   &#39;y_true&#39;: array([[[24.08, 22.52, 20.13, ..., 28.37, 27.24, 25.73],
           [26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
           [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
           ...,
           [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
           [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
           [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]]], dtype=float32),
   &#39;y_hat&#39;: array([[[19.412273, 19.126444, 20.053547, ..., 27.891233, 24.624166,
            23.361036],
           [20.027594, 17.538385, 18.871962, ..., 25.303629, 26.506376,
            22.397629],
           [24.973862, 21.848646, 18.8872  , ..., 26.280008, 29.561745,
            24.857964],
           ...,
           [37.114403, 40.771065, 56.270203, ..., 37.80784 , 53.470837,
            45.589592],
           [48.32659 , 43.981327, 42.255104, ..., 44.247105, 56.93128 ,
            59.505505],
           [59.68541 , 44.544304, 58.998516, ..., 53.16079 , 62.289055,
            62.664417]]], dtype=float32),
   &#39;trajectories&#39;: {&#39;iteration&#39;: [], &#39;train_loss&#39;: [], &#39;val_loss&#39;: []},
   &#39;run_time&#39;: 2.008603811264038,
   &#39;status&#39;: &#39;ok&#39;},
  &#39;misc&#39;: {&#39;tid&#39;: 0,
   &#39;cmd&#39;: (&#39;domain_attachment&#39;, &#39;FMinIter_Domain&#39;),
   &#39;workdir&#39;: None,
   &#39;idxs&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_theta&#39;: [0],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [0],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [0],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [0],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]},
   &#39;vals&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_theta&#39;: [0.43801632384236966],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [7.0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [1],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0.0008972627305368071],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0.47516554340200984],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [15.0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [2],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [0.000654293943235604],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]}},
  &#39;exp_key&#39;: None,
  &#39;owner&#39;: None,
  &#39;version&#39;: 0,
  &#39;book_time&#39;: datetime.datetime(2021, 5, 24, 22, 43, 12, 946000),
  &#39;refresh_time&#39;: datetime.datetime(2021, 5, 24, 22, 43, 14, 973000)},
 {&#39;state&#39;: 2,
  &#39;tid&#39;: 1,
  &#39;spec&#39;: None,
  &#39;result&#39;: {&#39;loss&#39;: 5.980691909790039,
   &#39;mc&#39;: {&#39;activation&#39;: &#39;SELU&#39;,
    &#39;batch_normalization&#39;: False,
    &#39;batch_size&#39;: 256,
    &#39;complete_inputs&#39;: False,
    &#39;complete_sample&#39;: False,
    &#39;device&#39;: &#39;cuda&#39;,
    &#39;dropout_prob_theta&#39;: 0.11391339143430734,
    &#39;early_stopping&#39;: 16,
    &#39;eval_freq&#39;: 50,
    &#39;exogenous_n_channels&#39;: 10.0,
    &#39;frequency&#39;: &#39;H&#39;,
    &#39;idx_to_sample_freq&#39;: 24,
    &#39;initialization&#39;: &#39;glorot_normal&#39;,
    &#39;input_size_multiplier&#39;: 7,
    &#39;l1_theta&#39;: 0,
    &#39;learning_rate&#39;: 0.0005122944017847571,
    &#39;len_sample_chunks&#39;: None,
    &#39;loss&#39;: &#39;MAE&#39;,
    &#39;loss_hypar&#39;: 0.5,
    &#39;lr_decay&#39;: 0.49911718595636395,
    &#39;mode&#39;: &#39;simple&#39;,
    &#39;model&#39;: &#39;nbeats&#39;,
    &#39;n_blocks&#39;: (1, 1),
    &#39;n_harmonics&#39;: 1,
    &#39;n_hidden&#39;: 364,
    &#39;n_iterations&#39;: 10,
    &#39;n_layers&#39;: (2, 2),
    &#39;n_lr_decay_steps&#39;: 3,
    &#39;n_polynomials&#39;: 2,
    &#39;n_series_per_batch&#39;: 1,
    &#39;n_val_weeks&#39;: 104,
    &#39;normalizer_x&#39;: &#39;median&#39;,
    &#39;normalizer_y&#39;: None,
    &#39;output_size&#39;: 24,
    &#39;random_seed&#39;: 16.0,
    &#39;seasonality&#39;: 24,
    &#39;shared_weights&#39;: False,
    &#39;stack_types&#39;: (&#39;exogenous_tcn&#39;, &#39;identity&#39;),
    &#39;val_idx_to_sample_freq&#39;: 24,
    &#39;val_loss&#39;: &#39;MAE&#39;,
    &#39;weight_decay&#39;: 8.620065472314436e-05,
    &#39;window_sampling_limit&#39;: 100000,
    &#39;x_s_n_hidden&#39;: 0,
    &#39;n_x&#39;: 1,
    &#39;n_s&#39;: 1,
    &#39;n_hidden_list&#39;: [[364, 364], [364, 364]]},
   &#39;y_true&#39;: array([[[24.08, 22.52, 20.13, ..., 28.37, 27.24, 25.73],
           [26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
           [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
           ...,
           [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
           [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
           [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]]], dtype=float32),
   &#39;y_hat&#39;: array([[[28.521648, 23.374033, 20.542292, ..., 25.10782 , 22.465616,
            21.961155],
           [26.816788, 25.160992, 18.4162  , ..., 24.674564, 21.958927,
            22.847815],
           [30.677185, 29.501476, 25.602867, ..., 29.384226, 27.477423,
            25.70232 ],
           ...,
           [52.580513, 48.315926, 54.070484, ..., 45.772327, 46.174297,
            57.708096],
           [66.14125 , 58.168346, 55.76279 , ..., 57.011993, 42.49214 ,
            60.894703],
           [60.013878, 40.39894 , 39.479916, ..., 49.292084, 38.055923,
            39.924675]]], dtype=float32),
   &#39;trajectories&#39;: {&#39;iteration&#39;: [], &#39;train_loss&#39;: [], &#39;val_loss&#39;: []},
   &#39;run_time&#39;: 2.036043405532837,
   &#39;status&#39;: &#39;ok&#39;},
  &#39;misc&#39;: {&#39;tid&#39;: 1,
   &#39;cmd&#39;: (&#39;domain_attachment&#39;, &#39;FMinIter_Domain&#39;),
   &#39;workdir&#39;: None,
   &#39;idxs&#39;: {&#39;activation&#39;: [1],
    &#39;batch_normalization&#39;: [1],
    &#39;batch_size&#39;: [1],
    &#39;complete_inputs&#39;: [1],
    &#39;complete_sample&#39;: [1],
    &#39;device&#39;: [1],
    &#39;dropout_prob_theta&#39;: [1],
    &#39;early_stopping&#39;: [1],
    &#39;eval_freq&#39;: [1],
    &#39;exogenous_n_channels&#39;: [1],
    &#39;frequency&#39;: [1],
    &#39;idx_to_sample_freq&#39;: [1],
    &#39;initialization&#39;: [1],
    &#39;input_size_multiplier&#39;: [1],
    &#39;l1_theta&#39;: [1],
    &#39;learning_rate&#39;: [1],
    &#39;len_sample_chunks&#39;: [1],
    &#39;loss&#39;: [1],
    &#39;loss_hypar&#39;: [1],
    &#39;lr_decay&#39;: [1],
    &#39;n_blocks&#39;: [1],
    &#39;n_harmonics&#39;: [1],
    &#39;n_hidden&#39;: [1],
    &#39;n_iterations&#39;: [1],
    &#39;n_layers&#39;: [1],
    &#39;n_lr_decay_steps&#39;: [1],
    &#39;n_polynomials&#39;: [1],
    &#39;n_series_per_batch&#39;: [1],
    &#39;n_val_weeks&#39;: [1],
    &#39;normalizer_x&#39;: [1],
    &#39;normalizer_y&#39;: [1],
    &#39;output_size&#39;: [1],
    &#39;random_seed&#39;: [1],
    &#39;seasonality&#39;: [1],
    &#39;shared_weights&#39;: [1],
    &#39;stack_types&#39;: [1],
    &#39;val_idx_to_sample_freq&#39;: [1],
    &#39;val_loss&#39;: [1],
    &#39;weight_decay&#39;: [1],
    &#39;window_sampling_limit&#39;: [1],
    &#39;x_s_n_hidden&#39;: [1]},
   &#39;vals&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_theta&#39;: [0.11391339143430734],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [10.0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [0],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0.0005122944017847571],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0.49911718595636395],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [16.0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [2],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [8.620065472314436e-05],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]}},
  &#39;exp_key&#39;: None,
  &#39;owner&#39;: None,
  &#39;version&#39;: 0,
  &#39;book_time&#39;: datetime.datetime(2021, 5, 24, 22, 43, 15, 14000),
  &#39;refresh_time&#39;: datetime.datetime(2021, 5, 24, 22, 43, 17, 75000)}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

