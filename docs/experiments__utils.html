---

title: Experiment Utils


keywords: fastai
sidebar: home_sidebar

summary: "Set of functions to easily perform experiments."
description: "Set of functions to easily perform experiments."
nb_path: "nbs/experiments__utils.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/experiments__utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_mask_dfs" class="doc_header"><code>get_mask_dfs</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L36" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_mask_dfs</code>(<strong><code>Y_df</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>ds_in_test</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_random_mask_dfs" class="doc_header"><code>get_random_mask_dfs</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L66" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_random_mask_dfs</code>(<strong><code>Y_df</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>n_ds_val_window</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>freq</code></strong>)</p>
</blockquote>
<p>Generates train, test and random validation mask.
Train mask begins by avoiding ds_in_test</p>
<p>Validation mask: 1) samples n_uids unique ids
                 2) creates windows of size n_ds_val_window</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>ds_in_test: int
    Number of ds in test.
n_uids: int
    Number of unique ids in validation.
n_val_windows: int
    Number of windows for validation.
n_ds_val_window: int
    Number of ds in each validation window.
periods: int
    ds_in_test multiplier.
freq: str
    string that determines datestamp frequency, used in
    random windows creation.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="scale_data" class="doc_header"><code>scale_data</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L122" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>scale_data</code>(<strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>mask_df</code></strong>, <strong><code>normalizer_y</code></strong>, <strong><code>normalizer_x</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_datasets" class="doc_header"><code>create_datasets</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L140" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_datasets</code>(<strong><code>mc</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_loaders" class="doc_header"><code>instantiate_loaders</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L199" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_loaders</code>(<strong><code>mc</code></strong>, <strong><code>train_dataset</code></strong>, <strong><code>val_dataset</code></strong>, <strong><code>test_dataset</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_nbeats" class="doc_header"><code>instantiate_nbeats</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L222" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_nbeats</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_esrnn" class="doc_header"><code>instantiate_esrnn</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L257" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_esrnn</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_mqesrnn" class="doc_header"><code>instantiate_mqesrnn</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L288" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_mqesrnn</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="instantiate_model" class="doc_header"><code>instantiate_model</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L316" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>instantiate_model</code>(<strong><code>mc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="model_fit_predict" class="doc_header"><code>model_fit_predict</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L323" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>model_fit_predict</code>(<strong><code>mc</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate_model" class="doc_header"><code>evaluate_model</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L400" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate_model</code>(<strong><code>mc</code></strong>, <strong><code>loss_function</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_test</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>, <strong><code>loss_kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hyperopt_tunning" class="doc_header"><code>hyperopt_tunning</code><a href="https://github.com/Grupo-Abraxas/nixtla/tree/master/nixtla/experiments/utils.py#L446" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hyperopt_tunning</code>(<strong><code>space</code></strong>, <strong><code>hyperopt_max_evals</code></strong>, <strong><code>loss_function</code></strong>, <strong><code>S_df</code></strong>, <strong><code>Y_df</code></strong>, <strong><code>X_df</code></strong>, <strong><code>f_cols</code></strong>, <strong><code>ds_in_val</code></strong>, <strong><code>n_uids</code></strong>, <strong><code>n_val_windows</code></strong>, <strong><code>freq</code></strong>, <strong><code>is_val_random</code></strong>, <strong><code>save_trials</code></strong>=<em><code>False</code></em>, <strong><code>loss_kwargs</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Experiment-Utils-Examples">Experiment Utils Examples<a class="anchor-link" href="#Experiment-Utils-Examples"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">t</span>
<span class="kn">from</span> <span class="nn">nixtla.losses.numpy</span> <span class="kn">import</span> <span class="n">mae</span><span class="p">,</span> <span class="n">mape</span><span class="p">,</span> <span class="n">smape</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">pinball_loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span>
<span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span> <span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span>  

<span class="n">nbeats_space</span><span class="o">=</span> <span class="p">{</span><span class="c1"># Architecture parameters</span>
               <span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;nbeats&#39;</span><span class="p">,</span>
               <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;simple&#39;</span><span class="p">,</span>
               <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">]),</span>
               <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;output_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;shared_weights&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;shared_weights&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;activation&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;selu&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;initialization&#39;</span><span class="p">:</span>  <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;initialization&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;glorot_normal&#39;</span><span class="p">,</span><span class="s1">&#39;he_normal&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;stack_types&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;stack_types&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">],</span>
                                                        <span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">],</span>
                                                        <span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_blocks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_blocks&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_layers&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_layers&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="p">]),</span>
               <span class="s1">&#39;n_hidden&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_hidden&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">364</span> <span class="p">]),</span>
               <span class="s1">&#39;n_harmonics&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_harmonics&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;n_polynomials&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_polynomials&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
               <span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
               <span class="c1"># Regularization and optimization parameters</span>
               <span class="s1">&#39;batch_normalization&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_normalization&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
               <span class="s1">&#39;dropout_prob_exogenous&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;dropout_prob_exogenous&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
               <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)),</span>
               <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="s1">&#39;lr_decay&#39;</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
               <span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
               <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;weight_decay&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-3</span><span class="p">)),</span>
               <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_iterations&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span> <span class="c1">#[args.max_epochs]),</span>
               <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;early_stopping&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">16</span><span class="p">]),</span>
               <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;eval_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;n_val_weeks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_val_weeks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">52</span><span class="o">*</span><span class="mi">2</span><span class="p">]),</span>
               <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;loss_hypar&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss_hypar&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]),</span>                
               <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span> <span class="c1">#[args.val_loss]),</span>
               <span class="s1">&#39;l1_theta&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;l1_theta&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
               <span class="c1"># Data parameters</span>
               <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_x&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;median&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100_000</span><span class="p">]),</span>
               <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_inputs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;complete_sample&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_sample&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]),</span>                
               <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;seasonality&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>      
               <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">256</span><span class="p">]),</span>
               <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;random_seed&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;device&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">device</span><span class="p">])}</span>

<span class="n">mc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;nbeats&#39;</span><span class="p">,</span>
      <span class="c1"># Architecture parameters</span>
      <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
      <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;shared_weights&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="s1">&#39;selu&#39;</span><span class="p">,</span>
      <span class="s1">&#39;initialization&#39;</span><span class="p">:</span> <span class="s1">&#39;he_normal&#39;</span><span class="p">,</span>
      <span class="s1">&#39;stack_types&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;exogenous_tcn&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="p">[</span><span class="s1">&#39;identity&#39;</span><span class="p">],</span>
      <span class="s1">&#39;n_blocks&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
      <span class="s1">&#39;n_layers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
      <span class="s1">&#39;n_hidden&#39;</span><span class="p">:</span> <span class="mi">364</span><span class="p">,</span>
      <span class="s1">&#39;n_polynomials&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s1">&#39;n_harmonics&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;exogenous_n_channels&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s1">&#39;x_s_n_hidden&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="c1"># Regularization and optimization parameters</span>
      <span class="s1">&#39;batch_normalization&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;dropout_prob_theta&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
      <span class="s1">&#39;dropout_prob_exogenous&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
      <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span> <span class="c1">#0.002,</span>
      <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="mf">0.64</span><span class="p">,</span>
      <span class="s1">&#39;n_lr_decay_steps&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.00015</span><span class="p">,</span>
      <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
      <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;n_val_weeks&#39;</span><span class="p">:</span> <span class="mi">52</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
      <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="s1">&#39;PINBALL&#39;</span><span class="p">,</span>
      <span class="s1">&#39;loss_hypar&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="c1">#0.49,</span>
      <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="s1">&#39;MAE&#39;</span><span class="p">,</span>
      <span class="s1">&#39;l1_theta&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="c1"># Data parameters</span>
      <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span>
      <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="mi">100_000</span><span class="p">,</span>
      <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;frequency&#39;</span><span class="p">:</span><span class="s1">&#39;H&#39;</span><span class="p">,</span>
      <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
      <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="s1">&#39;cpu&#39;</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">esrnn_space</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;esrnn&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;full&#39;</span><span class="p">,</span>
               <span class="c1"># Architecture parameters</span>
               <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">]),</span>
               <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;output_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;dilations&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;dilations&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">]]</span> <span class="p">]),</span>
               <span class="s1">&#39;es_component&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;es_component&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;multiplicative&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;cell_type&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;LSTM&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;state_hsize&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;state_hsize&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
               <span class="s1">&#39;add_nl_layer&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;add_nl_layer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]),</span>
               <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;seasonality&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="p">]),</span>
               <span class="c1"># Regularization and optimization parameters</span>
               <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span><span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_iterations&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span><span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;early_stopping&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;eval_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
               <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">32</span><span class="p">]),</span>
               <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">5e-4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)),</span>
               <span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">]),</span>
               <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;lr_decay&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
               <span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]),</span>
               <span class="s1">&#39;gradient_eps&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;gradient_eps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1e-8</span><span class="p">]),</span>
               <span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0005</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">]),</span>
               <span class="s1">&#39;noise_std&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s1">&#39;noise_std&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)),</span>
               <span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
               <span class="s1">&#39;testing_percentile&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;testing_percentile&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">]),</span>
               <span class="s1">&#39;training_percentile&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;training_percentile&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">]),</span>
               <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s1">&#39;random_seed&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;SMYL&#39;</span><span class="p">]),</span>
               <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]),</span>
               <span class="c1"># Data parameters</span>
               <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">500_000</span><span class="p">]),</span>
               <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_inputs&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">]),</span>
               <span class="s1">&#39;complete_sample&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;complete_sample&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">]),</span>
               <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">24</span><span class="p">]),</span>
               <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_y&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]),</span>
               <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;normalizer_x&#39;</span><span class="p">,</span>  <span class="p">[</span><span class="kc">None</span><span class="p">])}</span>

<span class="n">mc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="s1">&#39;esrnn&#39;</span><span class="p">,</span>
      <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;full&#39;</span><span class="p">,</span>
      <span class="c1"># Architecture parameters</span>
      <span class="s1">&#39;n_series&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;n_x&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;n_s&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;input_size_multiplier&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
      <span class="s1">&#39;output_size&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;dilations&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">]],</span>
      <span class="s1">&#39;es_component&#39;</span><span class="p">:</span> <span class="s1">&#39;multiplicative&#39;</span><span class="p">,</span>
      <span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;LSTM&#39;</span><span class="p">,</span>
      <span class="s1">&#39;state_hsize&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;add_nl_layer&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;seasonality&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">24</span><span class="p">],</span>
      <span class="c1"># Regularization and optimization parameters</span>
      <span class="s1">&#39;n_iterations&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span><span class="c1">#00,</span>
      <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;eval_freq&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
      <span class="s1">&#39;eq_batch_size&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
      <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span>
      <span class="s1">&#39;lr_scheduler_step_size&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s1">&#39;lr_decay&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
      <span class="s1">&#39;per_series_lr_multip&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
      <span class="s1">&#39;gradient_eps&#39;</span><span class="p">:</span> <span class="mf">1e-8</span><span class="p">,</span> 
      <span class="s1">&#39;gradient_clipping_threshold&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
      <span class="s1">&#39;rnn_weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
      <span class="s1">&#39;noise_std&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span>
      <span class="s1">&#39;level_variability_penalty&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s1">&#39;testing_percentile&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;training_percentile&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="s1">&#39;SMYL&#39;</span><span class="p">,</span>
      <span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="s1">&#39;MAE&#39;</span><span class="p">,</span>
      <span class="c1"># Data parameters</span>
      <span class="s1">&#39;len_sample_chunks&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;window_sampling_limit&#39;</span><span class="p">:</span> <span class="mi">500_000</span><span class="p">,</span>
      <span class="s1">&#39;complete_inputs&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
      <span class="s1">&#39;idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;val_idx_to_sample_freq&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
      <span class="s1">&#39;n_series_per_batch&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_y&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
      <span class="s1">&#39;normalizer_x&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">instantiate_esrnn</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nixtla.data.datasets.epf</span> <span class="kn">import</span> <span class="n">EPF</span><span class="p">,</span> <span class="n">EPFInfo</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NP&#39;</span><span class="p">]</span>

<span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="p">,</span> <span class="n">S_df</span> <span class="o">=</span> <span class="n">EPF</span><span class="o">.</span><span class="n">load_groups</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>

<span class="n">X_df</span> <span class="o">=</span> <span class="n">X_df</span><span class="p">[[</span><span class="s1">&#39;unique_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;week_day&#39;</span><span class="p">]]</span>
<span class="n">Y_min</span> <span class="o">=</span> <span class="n">Y_df</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="c1">#Y_df.y = Y_df.y - Y_min + 20</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y_df</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">loss_function</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span> <span class="n">mc</span><span class="o">=</span><span class="n">mc</span><span class="p">,</span> 
                        <span class="n">S_df</span><span class="o">=</span><span class="n">S_df</span><span class="p">,</span> <span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="n">X_df</span><span class="p">,</span> <span class="n">f_cols</span><span class="o">=</span><span class="p">[],</span>
                        <span class="n">ds_in_test</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ds_in_val</span><span class="o">=</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span>
                        <span class="n">n_uids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_val_windows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">is_val_random</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loss_kwargs</span><span class="o">=</span><span class="p">{})</span>
<span class="n">result</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================

model                                   esrnn
mode                                     full
n_series                                    1
n_x                                         1
n_s                                         1
input_size_multiplier                       7
output_size                                24
dilations                       [[1, 2], [7]]
es_component                   multiplicative
cell_type                                LSTM
state_hsize                                50
add_nl_layer                            False
seasonality                              [24]
n_iterations                               10
early_stopping                             10
eval_freq                                  10
batch_size                                 32
eq_batch_size                           False
learning_rate                          0.0005
lr_scheduler_step_size                    100
lr_decay                                  0.8
per_series_lr_multip                      1.5
gradient_eps                              0.0
gradient_clipping_threshold                20
rnn_weight_decay                          0.0
noise_std                              0.0005
level_variability_penalty                  10
testing_percentile                         50
training_percentile                        50
random_seed                                 1
loss                                     SMYL
val_loss                                  MAE
len_sample_chunks                         672
window_sampling_limit                  500000
complete_inputs                          True
idx_to_sample_freq                         24
val_idx_to_sample_freq                     24
n_series_per_batch                          1
normalizer_y                             None
normalizer_x                             None
dtype: object
===============================================

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

GPU available: False, used: False
TPU available: False, using: 0 TPU cores

  | Name  | Type   | Params
---------------------------------
0 | esrnn | _ESRNN | 124 K 
---------------------------------
124 K     Trainable params
0         Non-trainable params
124 K     Total params
0.499     Total estimated model params size (MB)
/home/federicogarza2/anaconda3/envs/nixtla/lib/python3.7/site-packages/pytorch_lightning/utilities/distributed.py:69: UserWarning: The dataloader, val dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 8 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  warnings.warn(*args, **kwargs)
/home/federicogarza2/anaconda3/envs/nixtla/lib/python3.7/site-packages/pytorch_lightning/utilities/distributed.py:69: UserWarning: The dataloader, train dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 8 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  warnings.warn(*args, **kwargs)
Metric val_loss improved. New best score: 4.441
Metric val_loss improved by 0.254 &gt;= min_delta = 0.0001. New best score: 4.187
Metric val_loss improved by 0.198 &gt;= min_delta = 0.0001. New best score: 3.988
Metric val_loss improved by 0.151 &gt;= min_delta = 0.0001. New best score: 3.837
Metric val_loss improved by 0.121 &gt;= min_delta = 0.0001. New best score: 3.717
Metric val_loss improved by 0.110 &gt;= min_delta = 0.0001. New best score: 3.607
Metric val_loss improved by 0.100 &gt;= min_delta = 0.0001. New best score: 3.507
Metric val_loss improved by 0.092 &gt;= min_delta = 0.0001. New best score: 3.415
Metric val_loss improved by 0.081 &gt;= min_delta = 0.0001. New best score: 3.334
Metric val_loss improved by 0.062 &gt;= min_delta = 0.0001. New best score: 3.272
/home/federicogarza2/anaconda3/envs/nixtla/lib/python3.7/site-packages/pytorch_lightning/utilities/distributed.py:69: UserWarning: The dataloader, predict dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 8 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  warnings.warn(*args, **kwargs)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>y_true.shape (#n_series, #n_fcds, #lt): (728, 24)
y_hat.shape (#n_series, #n_fcds, #lt): (728, 24)


</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;loss&#39;: 3.4759426,
 &#39;mc&#39;: {&#39;model&#39;: &#39;esrnn&#39;,
  &#39;mode&#39;: &#39;full&#39;,
  &#39;n_series&#39;: 1,
  &#39;n_x&#39;: 1,
  &#39;n_s&#39;: 1,
  &#39;input_size_multiplier&#39;: 7,
  &#39;output_size&#39;: 24,
  &#39;dilations&#39;: [[1, 2], [7]],
  &#39;es_component&#39;: &#39;multiplicative&#39;,
  &#39;cell_type&#39;: &#39;LSTM&#39;,
  &#39;state_hsize&#39;: 50,
  &#39;add_nl_layer&#39;: False,
  &#39;seasonality&#39;: [24],
  &#39;n_iterations&#39;: 10,
  &#39;early_stopping&#39;: 10,
  &#39;eval_freq&#39;: 10,
  &#39;batch_size&#39;: 32,
  &#39;eq_batch_size&#39;: False,
  &#39;learning_rate&#39;: 0.0005,
  &#39;lr_scheduler_step_size&#39;: 100,
  &#39;lr_decay&#39;: 0.8,
  &#39;per_series_lr_multip&#39;: 1.5,
  &#39;gradient_eps&#39;: 1e-08,
  &#39;gradient_clipping_threshold&#39;: 20,
  &#39;rnn_weight_decay&#39;: 0.0,
  &#39;noise_std&#39;: 0.0005,
  &#39;level_variability_penalty&#39;: 10,
  &#39;testing_percentile&#39;: 50,
  &#39;training_percentile&#39;: 50,
  &#39;random_seed&#39;: 1,
  &#39;loss&#39;: &#39;SMYL&#39;,
  &#39;val_loss&#39;: &#39;MAE&#39;,
  &#39;len_sample_chunks&#39;: 672,
  &#39;window_sampling_limit&#39;: 500000,
  &#39;complete_inputs&#39;: True,
  &#39;idx_to_sample_freq&#39;: 24,
  &#39;val_idx_to_sample_freq&#39;: 24,
  &#39;n_series_per_batch&#39;: 1,
  &#39;normalizer_y&#39;: None,
  &#39;normalizer_x&#39;: None},
 &#39;y_true&#39;: array([[24.08, 22.52, 20.13, ..., 28.37, 27.24, 25.73],
        [26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
        [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
        ...,
        [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
        [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
        [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]], dtype=float32),
 &#39;y_hat&#39;: array([[23.660404, 22.556707, 21.54966 , ..., 28.650946, 28.390427,
         24.104406],
        [24.301447, 22.897097, 21.590849, ..., 29.060732, 27.932867,
         24.419222],
        [27.537205, 26.618313, 24.665192, ..., 33.140076, 30.992815,
         28.662224],
        ...,
        [49.685978, 49.85029 , 48.283607, ..., 53.43113 , 49.95707 ,
         47.440365],
        [49.248276, 51.212193, 50.803574, ..., 54.849403, 53.65498 ,
         47.906372],
        [52.02505 , 51.713882, 52.2985  , ..., 55.870613, 55.896782,
         49.91361 ]], dtype=float32),
 &#39;run_time&#39;: 19.11681079864502,
 &#39;status&#39;: &#39;ok&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;y_hat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7fe93751de50&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trials</span> <span class="o">=</span> <span class="n">hyperopt_tunning</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">nbeats_space</span><span class="p">,</span> <span class="n">hyperopt_max_evals</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">loss_function</span><span class="o">=</span><span class="n">mae</span><span class="p">,</span>
                          <span class="n">S_df</span><span class="o">=</span><span class="n">S_df</span><span class="p">,</span> <span class="n">Y_df</span><span class="o">=</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">X_df</span><span class="o">=</span><span class="n">X_df</span><span class="p">,</span> <span class="n">f_cols</span><span class="o">=</span><span class="p">[],</span>
                          <span class="n">ds_in_val</span><span class="o">=</span><span class="mi">728</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span> <span class="n">n_uids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_val_windows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">is_val_random</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loss_kwargs</span><span class="o">=</span><span class="p">{})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>  0%|          | 0/2 [00:00&lt;?, ?trial/s, best loss=?]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:hyperopt.tpe:build_posterior_wrapper took 0.069091 seconds
INFO:hyperopt.tpe:TPE using 0 trials
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================      

activation                                selu       
batch_normalization                      False
batch_size                                 256
complete_inputs                          False
complete_sample                          False
device                                     cpu
dropout_prob_exogenous                0.289298
dropout_prob_theta                    0.480443
early_stopping                              16
eval_freq                                   50
exogenous_n_channels                       2.0
frequency                                    H
idx_to_sample_freq                          24
initialization                   glorot_normal
input_size_multiplier                        7
l1_theta                                     0
learning_rate                         0.000767
len_sample_chunks                         None
loss                                       MAE
loss_hypar                                 0.5
lr_decay                              0.481631
mode                                    simple
model                                   nbeats
n_blocks                                (1, 1)
n_harmonics                                  1
n_hidden                                   364
n_iterations                                10
n_layers                                (2, 2)
n_lr_decay_steps                             3
n_polynomials                                2
n_series_per_batch                           1
n_val_weeks                                104
normalizer_x                            median
normalizer_y                              None
output_size                                 24
random_seed                               17.0
seasonality                                 24
shared_weights                           False
stack_types               (identity, identity)
val_idx_to_sample_freq                      24
val_loss                                   MAE
weight_decay                          0.000608
window_sampling_limit                   100000
x_s_n_hidden                                 0
dtype: object
===============================================      

  0%|          | 0/2 [00:00&lt;?, ?trial/s, best loss=?]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>============================== Start fitting ==============================
Step: 10, Time: 0.806, Insample MAE: 2.97479, Outsample MAE: 2.81590
==============================  End fitting  ==============================
y_true.shape (#n_series, #n_fcds, #lt): (1, 728, 24) 
y_hat.shape (#n_series, #n_fcds, #lt): (1, 728, 24)  
 50%|█████     | 1/2 [00:06&lt;00:06,  6.14s/trial, best loss: 2.8159008026123047]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:hyperopt.tpe:build_posterior_wrapper took 0.061283 seconds
INFO:hyperopt.tpe:TPE using 1/1 trials with best loss 2.815901
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>===============================================                                

activation                                     selu                            
batch_normalization                           False
batch_size                                      256
complete_inputs                               False
complete_sample                               False
device                                          cpu
dropout_prob_exogenous                     0.031301
dropout_prob_theta                         0.388938
early_stopping                                   16
eval_freq                                        50
exogenous_n_channels                            1.0
frequency                                         H
idx_to_sample_freq                               24
initialization                        glorot_normal
input_size_multiplier                             7
l1_theta                                          0
learning_rate                              0.000578
len_sample_chunks                              None
loss                                            MAE
loss_hypar                                      0.5
lr_decay                                   0.312297
mode                                         simple
model                                        nbeats
n_blocks                                     (1, 1)
n_harmonics                                       1
n_hidden                                        364
n_iterations                                     10
n_layers                                     (2, 2)
n_lr_decay_steps                                  3
n_polynomials                                     2
n_series_per_batch                                1
n_val_weeks                                     104
normalizer_x                                 median
normalizer_y                                   None
output_size                                      24
random_seed                                    11.0
seasonality                                      24
shared_weights                                False
stack_types               (identity, exogenous_tcn)
val_idx_to_sample_freq                           24
val_loss                                        MAE
weight_decay                               0.001677
window_sampling_limit                        100000
x_s_n_hidden                                      0
dtype: object
===============================================                                

 50%|█████     | 1/2 [00:06&lt;00:06,  6.14s/trial, best loss: 2.8159008026123047]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2016-12-27 2018-12-24 23:00:00
          1           2013-01-01 2016-12-26 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=66.67, 	34944 time stamps 
Outsample percentage=33.33, 	17472 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2016-12-26 23:00:00
          1           2016-12-27 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=33.33, 	17472 time stamps 
Outsample percentage=66.67, 	34944 time stamps 

INFO:root:Train Validation splits

INFO:root:                              ds                    
                             min                 max
unique_id sample_mask                               
NP        0           2013-01-01 2018-12-24 23:00:00
INFO:root:
Total data 			52416 time stamps 
Available percentage=100.0, 	52416 time stamps 
Insample  percentage=0.0, 	0 time stamps 
Outsample percentage=100.0, 	52416 time stamps 

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>============================== Start fitting ==============================    
Step: 10, Time: 1.613, Insample MAE: 3.23716, Outsample MAE: 2.99633           
==============================  End fitting  ==============================    
y_true.shape (#n_series, #n_fcds, #lt): (1, 728, 24)                           
y_hat.shape (#n_series, #n_fcds, #lt): (1, 728, 24)                            
100%|██████████| 2/2 [00:11&lt;00:00,  5.82s/trial, best loss: 2.8159008026123047]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trials</span><span class="o">.</span><span class="n">trials</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;state&#39;: 2,
  &#39;tid&#39;: 0,
  &#39;spec&#39;: None,
  &#39;result&#39;: {&#39;loss&#39;: 2.8159008026123047,
   &#39;mc&#39;: {&#39;activation&#39;: &#39;selu&#39;,
    &#39;batch_normalization&#39;: False,
    &#39;batch_size&#39;: 256,
    &#39;complete_inputs&#39;: False,
    &#39;complete_sample&#39;: False,
    &#39;device&#39;: &#39;cpu&#39;,
    &#39;dropout_prob_exogenous&#39;: 0.28929779779858733,
    &#39;dropout_prob_theta&#39;: 0.48044316925294783,
    &#39;early_stopping&#39;: 16,
    &#39;eval_freq&#39;: 50,
    &#39;exogenous_n_channels&#39;: 2.0,
    &#39;frequency&#39;: &#39;H&#39;,
    &#39;idx_to_sample_freq&#39;: 24,
    &#39;initialization&#39;: &#39;glorot_normal&#39;,
    &#39;input_size_multiplier&#39;: 7,
    &#39;l1_theta&#39;: 0,
    &#39;learning_rate&#39;: 0.0007666156748713094,
    &#39;len_sample_chunks&#39;: None,
    &#39;loss&#39;: &#39;MAE&#39;,
    &#39;loss_hypar&#39;: 0.5,
    &#39;lr_decay&#39;: 0.4816309077685592,
    &#39;mode&#39;: &#39;simple&#39;,
    &#39;model&#39;: &#39;nbeats&#39;,
    &#39;n_blocks&#39;: (1, 1),
    &#39;n_harmonics&#39;: 1,
    &#39;n_hidden&#39;: 364,
    &#39;n_iterations&#39;: 10,
    &#39;n_layers&#39;: (2, 2),
    &#39;n_lr_decay_steps&#39;: 3,
    &#39;n_polynomials&#39;: 2,
    &#39;n_series_per_batch&#39;: 1,
    &#39;n_val_weeks&#39;: 104,
    &#39;normalizer_x&#39;: &#39;median&#39;,
    &#39;normalizer_y&#39;: None,
    &#39;output_size&#39;: 24,
    &#39;random_seed&#39;: 17.0,
    &#39;seasonality&#39;: 24,
    &#39;shared_weights&#39;: False,
    &#39;stack_types&#39;: (&#39;identity&#39;, &#39;identity&#39;),
    &#39;val_idx_to_sample_freq&#39;: 24,
    &#39;val_loss&#39;: &#39;MAE&#39;,
    &#39;weight_decay&#39;: 0.0006076449346361438,
    &#39;window_sampling_limit&#39;: 100000,
    &#39;x_s_n_hidden&#39;: 0,
    &#39;n_hidden_list&#39;: [[364, 364], [364, 364]]},
   &#39;y_true&#39;: array([[[24.08, 22.52, 20.13, ..., 28.37, 27.24, 25.73],
           [26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
           [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
           ...,
           [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
           [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
           [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]]], dtype=float32),
   &#39;y_hat&#39;: array([[[25.553757, 23.644003, 23.49163 , ..., 27.666134, 26.963339,
            26.859642],
           [25.791319, 23.59203 , 23.980074, ..., 27.624002, 26.850067,
            26.704662],
           [29.641472, 26.857468, 28.004498, ..., 31.268396, 30.397018,
            30.176214],
           ...,
           [49.76906 , 46.387184, 45.811184, ..., 51.648594, 50.358894,
            50.253967],
           [50.74701 , 49.076485, 47.330284, ..., 53.636894, 52.69619 ,
            52.45536 ],
           [51.393864, 50.796288, 47.62773 , ..., 55.455193, 54.101963,
            54.203506]]], dtype=float32),
   &#39;run_time&#39;: 5.976587533950806,
   &#39;status&#39;: &#39;ok&#39;},
  &#39;misc&#39;: {&#39;tid&#39;: 0,
   &#39;cmd&#39;: (&#39;domain_attachment&#39;, &#39;FMinIter_Domain&#39;),
   &#39;workdir&#39;: None,
   &#39;idxs&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_exogenous&#39;: [0],
    &#39;dropout_prob_theta&#39;: [0],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [0],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [0],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [0],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]},
   &#39;vals&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_exogenous&#39;: [0.28929779779858733],
    &#39;dropout_prob_theta&#39;: [0.48044316925294783],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [2.0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [0],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0.0007666156748713094],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0.4816309077685592],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [17.0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [0],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [0.0006076449346361438],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]}},
  &#39;exp_key&#39;: None,
  &#39;owner&#39;: None,
  &#39;version&#39;: 0,
  &#39;book_time&#39;: datetime.datetime(2021, 5, 14, 0, 7, 37, 378000),
  &#39;refresh_time&#39;: datetime.datetime(2021, 5, 14, 0, 7, 43, 432000)},
 {&#39;state&#39;: 2,
  &#39;tid&#39;: 1,
  &#39;spec&#39;: None,
  &#39;result&#39;: {&#39;loss&#39;: 2.9963347911834717,
   &#39;mc&#39;: {&#39;activation&#39;: &#39;selu&#39;,
    &#39;batch_normalization&#39;: False,
    &#39;batch_size&#39;: 256,
    &#39;complete_inputs&#39;: False,
    &#39;complete_sample&#39;: False,
    &#39;device&#39;: &#39;cpu&#39;,
    &#39;dropout_prob_exogenous&#39;: 0.03130108243252089,
    &#39;dropout_prob_theta&#39;: 0.38893784089395794,
    &#39;early_stopping&#39;: 16,
    &#39;eval_freq&#39;: 50,
    &#39;exogenous_n_channels&#39;: 1.0,
    &#39;frequency&#39;: &#39;H&#39;,
    &#39;idx_to_sample_freq&#39;: 24,
    &#39;initialization&#39;: &#39;glorot_normal&#39;,
    &#39;input_size_multiplier&#39;: 7,
    &#39;l1_theta&#39;: 0,
    &#39;learning_rate&#39;: 0.0005778209645778988,
    &#39;len_sample_chunks&#39;: None,
    &#39;loss&#39;: &#39;MAE&#39;,
    &#39;loss_hypar&#39;: 0.5,
    &#39;lr_decay&#39;: 0.3122966170495453,
    &#39;mode&#39;: &#39;simple&#39;,
    &#39;model&#39;: &#39;nbeats&#39;,
    &#39;n_blocks&#39;: (1, 1),
    &#39;n_harmonics&#39;: 1,
    &#39;n_hidden&#39;: 364,
    &#39;n_iterations&#39;: 10,
    &#39;n_layers&#39;: (2, 2),
    &#39;n_lr_decay_steps&#39;: 3,
    &#39;n_polynomials&#39;: 2,
    &#39;n_series_per_batch&#39;: 1,
    &#39;n_val_weeks&#39;: 104,
    &#39;normalizer_x&#39;: &#39;median&#39;,
    &#39;normalizer_y&#39;: None,
    &#39;output_size&#39;: 24,
    &#39;random_seed&#39;: 11.0,
    &#39;seasonality&#39;: 24,
    &#39;shared_weights&#39;: False,
    &#39;stack_types&#39;: (&#39;identity&#39;, &#39;exogenous_tcn&#39;),
    &#39;val_idx_to_sample_freq&#39;: 24,
    &#39;val_loss&#39;: &#39;MAE&#39;,
    &#39;weight_decay&#39;: 0.0016766858195201631,
    &#39;window_sampling_limit&#39;: 100000,
    &#39;x_s_n_hidden&#39;: 0,
    &#39;n_hidden_list&#39;: [[364, 364], [364, 364]]},
   &#39;y_true&#39;: array([[[24.08, 22.52, 20.13, ..., 28.37, 27.24, 25.73],
           [26.45, 26.26, 26.24, ..., 30.65, 30.02, 29.37],
           [29.26, 28.72, 28.29, ..., 30.01, 29.44, 28.76],
           ...,
           [48.39, 47.72, 47.23, ..., 52.05, 51.09, 50.47],
           [51.49, 50.83, 50.74, ..., 53.99, 53.86, 52.32],
           [51.09, 50.19, 48.98, ..., 49.09, 49.02, 48.1 ]]], dtype=float32),
   &#39;y_hat&#39;: array([[[23.633694, 24.35271 , 24.624672, ..., 26.689724, 27.338158,
            24.985489],
           [23.667044, 24.462255, 24.811537, ..., 26.824455, 27.503576,
            25.334995],
           [27.392181, 28.317717, 28.523794, ..., 30.436089, 31.310572,
            28.68882 ],
           ...,
           [44.681576, 44.16534 , 45.895912, ..., 48.89774 , 49.520634,
            45.86713 ],
           [46.594593, 45.77643 , 46.96487 , ..., 49.81616 , 50.920574,
            47.49068 ],
           [50.13418 , 50.002533, 49.951965, ..., 54.58797 , 55.344482,
            50.813007]]], dtype=float32),
   &#39;run_time&#39;: 5.38176155090332,
   &#39;status&#39;: &#39;ok&#39;},
  &#39;misc&#39;: {&#39;tid&#39;: 1,
   &#39;cmd&#39;: (&#39;domain_attachment&#39;, &#39;FMinIter_Domain&#39;),
   &#39;workdir&#39;: None,
   &#39;idxs&#39;: {&#39;activation&#39;: [1],
    &#39;batch_normalization&#39;: [1],
    &#39;batch_size&#39;: [1],
    &#39;complete_inputs&#39;: [1],
    &#39;complete_sample&#39;: [1],
    &#39;device&#39;: [1],
    &#39;dropout_prob_exogenous&#39;: [1],
    &#39;dropout_prob_theta&#39;: [1],
    &#39;early_stopping&#39;: [1],
    &#39;eval_freq&#39;: [1],
    &#39;exogenous_n_channels&#39;: [1],
    &#39;frequency&#39;: [1],
    &#39;idx_to_sample_freq&#39;: [1],
    &#39;initialization&#39;: [1],
    &#39;input_size_multiplier&#39;: [1],
    &#39;l1_theta&#39;: [1],
    &#39;learning_rate&#39;: [1],
    &#39;len_sample_chunks&#39;: [1],
    &#39;loss&#39;: [1],
    &#39;loss_hypar&#39;: [1],
    &#39;lr_decay&#39;: [1],
    &#39;n_blocks&#39;: [1],
    &#39;n_harmonics&#39;: [1],
    &#39;n_hidden&#39;: [1],
    &#39;n_iterations&#39;: [1],
    &#39;n_layers&#39;: [1],
    &#39;n_lr_decay_steps&#39;: [1],
    &#39;n_polynomials&#39;: [1],
    &#39;n_series_per_batch&#39;: [1],
    &#39;n_val_weeks&#39;: [1],
    &#39;normalizer_x&#39;: [1],
    &#39;normalizer_y&#39;: [1],
    &#39;output_size&#39;: [1],
    &#39;random_seed&#39;: [1],
    &#39;seasonality&#39;: [1],
    &#39;shared_weights&#39;: [1],
    &#39;stack_types&#39;: [1],
    &#39;val_idx_to_sample_freq&#39;: [1],
    &#39;val_loss&#39;: [1],
    &#39;weight_decay&#39;: [1],
    &#39;window_sampling_limit&#39;: [1],
    &#39;x_s_n_hidden&#39;: [1]},
   &#39;vals&#39;: {&#39;activation&#39;: [0],
    &#39;batch_normalization&#39;: [0],
    &#39;batch_size&#39;: [0],
    &#39;complete_inputs&#39;: [0],
    &#39;complete_sample&#39;: [0],
    &#39;device&#39;: [0],
    &#39;dropout_prob_exogenous&#39;: [0.03130108243252089],
    &#39;dropout_prob_theta&#39;: [0.38893784089395794],
    &#39;early_stopping&#39;: [0],
    &#39;eval_freq&#39;: [0],
    &#39;exogenous_n_channels&#39;: [1.0],
    &#39;frequency&#39;: [0],
    &#39;idx_to_sample_freq&#39;: [0],
    &#39;initialization&#39;: [0],
    &#39;input_size_multiplier&#39;: [0],
    &#39;l1_theta&#39;: [0],
    &#39;learning_rate&#39;: [0.0005778209645778988],
    &#39;len_sample_chunks&#39;: [0],
    &#39;loss&#39;: [0],
    &#39;loss_hypar&#39;: [0],
    &#39;lr_decay&#39;: [0.3122966170495453],
    &#39;n_blocks&#39;: [0],
    &#39;n_harmonics&#39;: [0],
    &#39;n_hidden&#39;: [0],
    &#39;n_iterations&#39;: [0],
    &#39;n_layers&#39;: [0],
    &#39;n_lr_decay_steps&#39;: [0],
    &#39;n_polynomials&#39;: [0],
    &#39;n_series_per_batch&#39;: [0],
    &#39;n_val_weeks&#39;: [0],
    &#39;normalizer_x&#39;: [0],
    &#39;normalizer_y&#39;: [0],
    &#39;output_size&#39;: [0],
    &#39;random_seed&#39;: [11.0],
    &#39;seasonality&#39;: [0],
    &#39;shared_weights&#39;: [0],
    &#39;stack_types&#39;: [1],
    &#39;val_idx_to_sample_freq&#39;: [0],
    &#39;val_loss&#39;: [0],
    &#39;weight_decay&#39;: [0.0016766858195201631],
    &#39;window_sampling_limit&#39;: [0],
    &#39;x_s_n_hidden&#39;: [0]}},
  &#39;exp_key&#39;: None,
  &#39;owner&#39;: None,
  &#39;version&#39;: 0,
  &#39;book_time&#39;: datetime.datetime(2021, 5, 14, 0, 7, 43, 508000),
  &#39;refresh_time&#39;: datetime.datetime(2021, 5, 14, 0, 7, 48, 929000)}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

